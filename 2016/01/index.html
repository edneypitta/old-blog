<!doctype html>
	<!--[if !IE]>
	<html class="no-js non-ie" lang="pt-BR" prefix="og: http://ogp.me/ns#"> <![endif]-->
	<!--[if IE 7 ]>
	<html class="no-js ie7" lang="pt-BR" prefix="og: http://ogp.me/ns#"> <![endif]-->
	<!--[if IE 8 ]>
	<html class="no-js ie8" lang="pt-BR" prefix="og: http://ogp.me/ns#"> <![endif]-->
	<!--[if IE 9 ]>
	<html class="no-js ie9" lang="pt-BR" prefix="og: http://ogp.me/ns#"> <![endif]-->
	<!--[if gt IE 9]><!-->
<html class="no-js" lang="pt-BR" prefix="og: http://ogp.me/ns#"> <!--<![endif]-->
<head>
<base href="https://edneypitta.github.io/old-blog" />

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">



<title>janeiro 2016 - Edney Pitta</title>

<!-- This site is optimized with the Yoast SEO plugin v3.0.7 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="noindex,follow"/>
<link rel="canonical" href="https://edneypitta.github.io/old-blog/2016/01/" />
<meta property="og:locale" content="pt_BR" />
<meta property="og:type" content="object" />
<meta property="og:title" content="janeiro 2016 - Edney Pitta" />
<meta property="og:url" content="https://edneypitta.github.io/old-blog/2016/01/" />
<meta property="og:site_name" content="Edney Pitta" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="janeiro 2016 - Edney Pitta"/>
<meta name="twitter:site" content="@edneypitta"/>
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />


		<script type="text/javascript">
			
			
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='sparkling-bootstrap-css'  href='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/css/bootstrap.min.css?ver=4.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='sparkling-icons-css'  href='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/css/font-awesome.min.css?ver=4.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='sparkling-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans%3A400italic%2C400%2C600%2C700%7CRoboto+Slab%3A400%2C300%2C700&#038;ver=4.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='sparkling-style-css'  href='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/style.css?ver=4.8.2' type='text/css' media='all' />
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/js/modernizr.min.js?ver=4.8.2'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/js/bootstrap.min.js?ver=4.8.2'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/js/functions.min.js?ver=4.8.2'></script>
<link rel='https://api.w.org/' href='https://edneypitta.github.io/old-blog/wp-json/' />

 

<script data-cfasync="false" src="//load.sumome.com/" data-sumo-site-id="025f16b2b72012bef5c86b74ea4d0bd0652e8245a2df8c61ed302458c0f98f3b" async></script><style type="text/css">.entry-content {font-family: Open Sans; font-size:14px; font-weight: normal; color:#6B6B6B;}.navbar > .container .navbar-brand {
font-size: 35px;
margin-top: 7px;
}

#menu-social i{
font-size:17px;
}
#menu-social-1 i {
font-size:22px;
}

article ul {
    list-style: none;
    padding:0;
    margin:0;
margin-bottom: 10px;
}

article li { 
    padding-left: 1em; 
    text-indent: -.7em;
}

article li:before {
    content: "\2022";
    color: rgb(191, 66, 78); 
padding-right:7px;
font-size: 15px;
}

#logo {
margin: 10px 0px;
}

.textwidget a:hover h2{
color:#c9302c;
}</style>	<style type="text/css">
			.navbar > .container .navbar-brand {
			color: #ffffff;
		}
		</style>
	<link rel="icon" href="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/cropped-cropped-edneypitta-oficialissimo-fundo-branco-32x32.png" sizes="32x32" />
<link rel="icon" href="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/cropped-cropped-edneypitta-oficialissimo-fundo-branco-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/cropped-cropped-edneypitta-oficialissimo-fundo-branco-180x180.png" />
<meta name="msapplication-TileImage" content="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/cropped-cropped-edneypitta-oficialissimo-fundo-branco-270x270.png" />

<script type="text/javascript">
jQuery(document).ready(function()
{
jQuery('.fa-linkedin-square').parent().attr('target', '_blank').attr('title', 'LinkedIn');
jQuery('.fa-facebook-square').parent().attr('target', '_blank').attr('title', 'Facebook');
jQuery('.fa-twitter-square').parent().attr('target', '_blank').attr('title', 'Twitter');
jQuery('.fa-rss').parent().attr('target', '_blank').attr('title', 'RSS');

jQuery('.fa-info-circle').parent().attr('title', 'Sobre');
});
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66613004-1', 'auto');
  ga('send', 'pageview');

</script>
</head>

<body class="archive date">
<div id="page" class="hfeed site">

	<header id="masthead" class="site-header" role="banner">
		<nav class="navbar navbar-default" role="navigation">
			<div class="container">
				<div class="row">
					<div class="site-navigation-inner col-sm-12">
						<div class="navbar-header">
							<button type="button" class="btn navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
								<span class="sr-only">Toggle navigation</span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
							</button>

							
							<div id="logo">
								<a href="https://edneypitta.github.io/old-blog/"><img src="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/cropped-edneypitta-oficialissimo-fundo-branco.png"  height="84" width="411" alt="Edney Pitta"/></a>
							</div><!-- end of #logo -->

							
							
						</div>
						<div class="collapse navbar-collapse navbar-ex1-collapse"><ul id="menu-social" class="nav navbar-nav"><li id="menu-item-20" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20"><a title="&lt;i class=&quot;fa fa-linkedin-square&quot;&gt;&lt;/i&gt;" href="https://br.linkedin.com/in/edneypitta"><i class="fa fa-linkedin-square"></i></a></li>
<li id="menu-item-22" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22"><a title="&lt;i class=&quot;fa fa-facebook-square&quot;&gt;&lt;/i&gt;" href="https://www.facebook.com/edneypitta"><i class="fa fa-facebook-square"></i></a></li>
<li id="menu-item-23" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-23"><a title="&lt;i class=&quot;fa fa-twitter-square&quot;&gt;&lt;/i&gt;" href="https://twitter.com/edneypitta"><i class="fa fa-twitter-square"></i></a></li>
<li id="menu-item-24" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24"><a title="&lt;i class=&quot;fa fa-rss&quot;&gt;&lt;/i&gt;" href="https://edneypitta.github.io/old-blog/feed/"><i class="fa fa-rss"></i></a></li>
<li id="menu-item-27" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-27"><a title="&lt;i class=&quot;fa fa-info-circle&quot;&gt;&lt;/i&gt;" href="https://edneypitta.github.io/old-blog/sobre/"><i class="fa fa-info-circle"></i></a></li>
</ul></div>					</div>
				</div>
			</div>
		</nav><!-- .site-navigation -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">

		<div class="top-section">
								</div>

		<div class="container main-content-area">
			<div class="row">
				<div class="main-content-inner col-sm-12 col-md-8 pull-left">

	<section id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			<header class="page-header">
				<h1 class="page-title">
					Mês: <span>janeiro 2016</span>				</h1>
							</header><!-- .page-header -->

						
				
<article id="post-363" class="post-363 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
	<div class="blog-item-wrap">
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-5-create-an-entity-framework-data-model/" title="Certificação Microsoft 70-487: Objetivo 2.5 – Create an Entity Framework data model" >
			 				</a>
		<div class="post-inner-content">
			<header class="entry-header page-header">

				<h1 class="entry-title"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-5-create-an-entity-framework-data-model/" rel="bookmark">Certificação Microsoft 70-487: Objetivo 2.5 – Create an Entity Framework data model</a></h1>

								<div class="entry-meta">
					<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-5-create-an-entity-framework-data-model/" rel="bookmark"><time class="entry-date published" datetime="2016-01-27T23:22:43+00:00">27/01/2016</time><time class="updated" datetime="2016-03-01T16:57:07+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>				<span class="comments-link"><i class="fa fa-comment-o"></i><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-5-create-an-entity-framework-data-model/#respond"><span class="dsq-postid" data-dsqidentifier="363 https://edneypitta.github.io/old-blog/?p=363">Deixe um comentário</span></a></span>
				
				
				</div><!-- .entry-meta -->
							</header><!-- .entry-header -->

						<div class="entry-content">

				<p>Olá!</p>
<p>O objetivo 2.5 da certificação, Create an Entity Framework data model, é o último objetivo do segundo tópico da certificação, <strong>Querying and manipulating data by using the Entity Framework</strong>. Finalmente vamos ver como construir um Entity Model, além de recordar alguns conceitos e componentes do EF cobertos no objetivo 1.1.</p>
<p>Esse objetivo cobre como: 1) estruturar o model usando as heranças Table-per-Type e Table-per-Hierarchy, 2) escolher e implementar um método de data model (Model First ou Database First), 3) implementar objetos POCO e 4) descrever um data model usando Conceptual Schema Definitions, Storage Schema Definition, e Mapping Language (CSDL, SSDL, MSL). Vamos lá?</p>
<h2>Estruturando o Data Model Usando as Heranças Table-per-Type e Table-per-Hierarchy</h2>
<p>Você pode tratar os casos de herança de duas formas: Table-per-Type (tabela por tipo) e Table-per-Hierarchy (tabela por hierarquia). </p>
<p>Basicamente, a diferença entre as duas é que, em tabela por tipo, cada classe herdeira vira uma tabela no banco de dados. Em tabela por hierarquia, tanto a classe pai quanto as filhas ficarão guardadas na mesma tabela, geralmente com uma coluna indicando qual é o tipo.</p>
<p>Para o exame, você deve saber quais são as vantagens e desvantagens das duas formas:</p>
<h4>Tabela Por Tipo</h4>
<p>Vantagens:</p>
<ul>
<li>Os dados não são guardados redundantemente;</li>
<li>Os dados são armazenados na terceira norma formal, aumentando a integridade;</li>
<li>A implementação é mais simples. Para adicionar ou remover uma entidade herdeira, basta deletar a tabela no banco de dados e atualizar o Entity Model.</li>
</ul>
<p>Desvantagens:</p>
<ul>
<li>A performance é afetada em operações básicas (CRUD);</li>
<li>Complica a administração do banco de dados pelas tabelas adicionais.</li>
</ul>
<h4>Tabela Por Hierarquia</h4>
<p>Vantagens:</p>
<ul>
<li>Deixa o schema do banco simplificado por conter menos tabelas;</li>
<li>Operações de CRUD otimizadas por trabalhar em uma só tabela.</li>
</ul>
<p>Desvantagens:</p>
<ul>
<li>Há redundância dos dados por não seguir a terceira normal formal;</li>
<li>Pode haver problemas com a integridade dos dados devido a redundância;</li>
<li>O Entity Model fica mais complexo pela tabela conter mais campos.</li>
</ul>
<h2>Escolher e Implementar um Método de Data Model (Model First ou Database First)</h2>
<p>Escolher um modelo de EDM é um conceito importante, mas não há muito o que aprender aqui.</p>
<p><strong>Model First</strong> acontece quando você cria um modelo vazio e vai criando os recursos necessários, como as entidades, os relacionamentos entre elas e o comportamento das propriedades. Depois disso tudo, você gera o schema do banco de dados do EDM; e o Entity Framework cuida da criação do banco de dados e o mapeamento entre o banco e o modelo.</p>
<p><strong>Database First</strong>, como esperado, assume que você já tem o schema do banco de dados pronto e escolhe criar o EDM a partir dele. Nesse caso, o Entity Framework cuida da criação dos itens do EDM e o mapeamento entre eles.</p>
<p>Outro ponto importante nesse assunto são as propriedades que você pode setar diretamente no EDM, escolhendo qualquer um dos dois métodos. Clicando com o botão direito no designer e indo em Properties, você pode controlar algumas propriedades que têm o nome bem sugestivo, como se o Lazy Loading deve ser utilizado, o nome do namespace desejado, o nível de acesso dos containers, etc. </p>
<p>Indo nas propriedades de cada entidade ou em alguma propriedade, há alguns comportamentos e configurações que podem ser alterados:</p>
<ul>
<li>A classe base da entidade;</li>
<li>Se a propriedade é Nullable;</li>
<li>Visibilidade dos getters e setters;</li>
<li>Um valor default para uma propriedade;</li>
<li>Essa é bem interessante: a propriedade <strong>Concurrency Mode</strong>, quando setada para <em>Fixed</em>, assegura que o valor no banco de dados não foi alterado quando você vai atualizá-lo. Por exemplo, se você obteve uma entidade do banco com uma propriedade no valor &#8220;x&#8221; e vai alterá-la para &#8220;y&#8221;, o Entity Framework vai validar se o valor ainda é &#8220;x&#8221; antes de você atualizá-lo para &#8220;y&#8221;. Isso pode ser bem útil em alguns cenários, mas carrega uma piora na performance pela validação. Outro ponto é que, embora esse comportamento seja definido no nível de propriedade, se você tiver 50 campos setados para Fixed, apenas uma query será feita no banco para comparar os 50 valores.</li>
</ul>
<h2>Implementar Objetos POCO</h2>
<p>Ao criar uma entidade no EDM, o Entity Framework vai gerar a classe .NET automaticamente. Caso desejado, você pode desabilitar esse comportamento nas Properties do designer e criar você mesmo um POCO (<em>plain old common object</em>), tendo mais controle sobre suas classes.</p>
<p>Para usar suas classes POCO no contexto do EF, alguns passos são necessários. A primeira coisa é que as classes devem ser decoradas com o atributo Table, especificando o nome da tabela no banco de dados:</p>
<p><code>[Table("Account")]<br />
public class Account{}<br />
[Table("Customers")]<br />
public class Customers{}<br />
[Table("TransactionDetails")]<br />
public class TransactionDetail{}<br />
Table("Transactions")]<br />
public class Transaction{}</code></p>
<p>O modo de vincular as classes no contexto depende se você estiver utilizando DbContext ou ObjectContext.</p>
<p>Com DbContext, basta definir as classes usando a classe genérica DbSet e passando o tipo de cada POCO:</p>
<p><code>public partial class EntityFrameworkSamplesEntitiesDb : DbContext<br />
{<br />
 public EntityFrameworkSamplesEntitiesDb(): base("name=EntityFrameworkSamplesEntities1")<br />
{}<br />
public DbSet<Account> Accounts { get; set; }<br />
public DbSet<Customer> Customers { get; set; }<br />
public DbSet<TransactionDetail> TransactionDetails { get; set; }<br />
public DbSet<Transaction> Transactions { get; set; }<br />
}</code></p>
<p>Com ObjectContext não é muito diferente. A classe genérica ObjectSet deve ser usada e as propriedades devem ser inicializadas no construtor:</p>
<p><code>public partial class EntityFrameworkSamplesEntitiesSample : ObjectContext<br />
{<br />
 public EntityFrameworkSamplesEntitiesSample(): base("name=EntityFrameworkSamplesEntities1")<br />
{<br />
 Accounts = new ObjectSet<Account>();<br />
 Customers = new ObjectSet<Customer>();<br />
 TransactionDetails = new ObjectSet<TransactionDetail>();<br />
 Transactions = new ObjectSet<Transaction>();<br />
}<br />
 public ObjectSet<Account> Accounts { get; set; }<br />
 public ObjectSet<Customer> Customers { get; set; }<br />
 public ObjectSet<TransactionDetail> TransactionDetails { get; set; }<br />
 public ObjectSet<Transaction> Transactions { get; set; }<br />
}</code></p>
<h2>Descrever um Data Model Usando Conceptual Schema Definitions, Storage Schema Definition, e Mapping Language (CSDL, SSDL, MSL)</h2>
<p>O Entity Framework junta cada um desses componentes no arquivo .edmx, mas para o exame é importante entender qual o papel de cada um. Basicamente, o CSDL é o conceito do schema do banco traduzido para objetos; o SSDL representa o próprio schema do banco de dados e o MSL é o responsável por juntar os dois e mapear o schema do banco com os objetos.</p>
<p>Não há muito o que ir mais fundo sobre o CSDL e o SSDL, a não ser que são XMLs representando informações &#8211; objetos e modelos relacionais de banco de dados. O MSL, que unifica os dois, é um pouco mais complexo e merece um entendimento maior.</p>
<p>O MSL, junto com o .edmx, contém vários outros arquivos gerados automaticamente. São eles:</p>
<ul>
<li>Um arquivo .edmx que serve como container para tudo;</li>
<li>Um arquivo <em>ModelName.Context.tt</em> para geração de templates das classes .NET especificadas no model do respectivo contexto;</li>
<li>O arquivo <em>ModelName.Context.cs</em> que contém as classes do contexto;</li>
<li>O arquivo <em>ModelName.Designer.cs</em> que provê suporte para o designer do EDM;</li>
<li> Um arquivo <em>ModelName.edmx.Diagram</em> que contém um XML parecido com o seguinte:<br />
<code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br /> &lt;edmx:Edmx Version=&quot;2.0&quot; xmlns:edmx=&quot;http://schemas.microsoft.com/ado/2008/10/edmx&quot;&gt;<br /> &lt;!-- EF Designer content (DO NOT EDIT MANUALLY BELOW HERE) --&gt;<br /> &lt;edmx:Designer xmlns=&quot;http://schemas.microsoft.com/ado/2008/10/edmx&quot;&gt;<br /> &lt;!-- Diagram content (shape and connector positions) --&gt;<br /> &lt;edmx:Diagrams&gt;<br />&lt;Diagram DiagramId=&quot;8576b1de6991436caba647ac89886831&quot; Name=&quot;Diagram1&quot;&gt;<br />&lt;EntityTypeShape EntityType=&quot;EntityFrameworkSamplesModel1.Account&quot; Width=&quot;1.5&quot; PointX=&quot;7.5&quot; PointY=&quot;0.875&quot; IsExpanded=&quot;true&quot; /&gt;<br />&lt;EntityTypeShape EntityType=&quot;EntityFrameworkSamplesModel1.Customer&quot; Width=&quot;1.5&quot; PointX=&quot;9.75&quot; PointY=&quot;0.875&quot; IsExpanded=&quot;true&quot; /&gt;<br />&lt;EntityTypeShape EntityType=&quot;EntityFrameworkSamplesModel1.TransactionDetail&quot; Width=&quot;1.5&quot; PointX=&quot;14.25&quot; PointY=&quot;0.875&quot; IsExpanded=&quot;true&quot; /&gt;<br />&lt;EntityTypeShape EntityType=&quot;EntityFrameworkSamplesModel1.Transaction&quot; Width=&quot;1.5&quot; PointX=&quot;12&quot; PointY=&quot;0.875&quot; IsExpanded=&quot;true&quot; /&gt;<br />&lt;AssociationConnector Association=&quot;EntityFrameworkSamplesModel1.FK_Account_Account&quot; ManuallyRouted=&quot;false&quot; /&gt;<br />&lt;AssociationConnector Association=&quot;EntityFrameworkSamplesModel1.FK_Customer_Account&quot; ManuallyRouted=&quot;false&quot; /&gt;<br />&lt;AssociationConnector Association=&quot;EntityFrameworkSamplesModel1.FK_Transactions_Customer&quot; ManuallyRouted=&quot;false&quot; /&gt;<br />&lt;AssociationConnector Association=&quot;EntityFrameworkSamplesModel1.FK_TransactionDetails_Transactions&quot; ManuallyRouted=&quot;false&quot; /&gt;<br />&lt;/Diagram&gt;<br />&lt;/edmx:Diagrams&gt;<br />&lt;/edmx:Designer&gt;<br />&lt;/edmx:Edmx&gt;</code>
</li>
<li>Por último, o arquivo <em>ModelName.tt</em> que tem as informações de template para geração das classes de dados.</li>
</ul>
<p>Uma olhada no arquivo .edmx pode ajudar na visualização de todos esses artefatos:</p>
<p><img src="https://edneypitta.github.io/old-blog/wp-content/uploads/2016/01/edmx.png" alt="edmx" width="426" height="878" class="aligncenter size-full wp-image-367" srcset="https://edneypitta.github.io/old-blog/wp-content/uploads/2016/01/edmx.png 426w, https://edneypitta.github.io/old-blog/wp-content/uploads/2016/01/edmx-146x300.png 146w" sizes="(max-width: 426px) 100vw, 426px" /></p>
<p>Isso é tudo para esse objetivo. O próximo post cobrirá o primeiro objetivo do capítulo 3 da certificação, <strong><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-3-1-create-a-wcf-service/">Designing and implementing WCF Services</a></strong>.</p>
<p>Nos vemos lá!</p>

				<p><a class="btn btn-default read-more" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-5-create-an-entity-framework-data-model/" title="Certificação Microsoft 70-487: Objetivo 2.5 – Create an Entity Framework data model">Leia Mais</a></p>

							</div><!-- .entry-content -->
					</div>
	</div>
</article><!-- #post-## -->

			
				
<article id="post-349" class="post-349 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
	<div class="blog-item-wrap">
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-4-query-and-manipulate-data-by-using-ado-net/" title="Certificação Microsoft 70-487: Objetivo 2.4 – Query and manipulate data by using ADO.NET" >
			 				</a>
		<div class="post-inner-content">
			<header class="entry-header page-header">

				<h1 class="entry-title"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-4-query-and-manipulate-data-by-using-ado-net/" rel="bookmark">Certificação Microsoft 70-487: Objetivo 2.4 – Query and manipulate data by using ADO.NET</a></h1>

								<div class="entry-meta">
					<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-4-query-and-manipulate-data-by-using-ado-net/" rel="bookmark"><time class="entry-date published" datetime="2016-01-22T22:24:19+00:00">22/01/2016</time><time class="updated" datetime="2016-03-01T16:57:01+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>				<span class="comments-link"><i class="fa fa-comment-o"></i><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-4-query-and-manipulate-data-by-using-ado-net/#respond"><span class="dsq-postid" data-dsqidentifier="349 https://edneypitta.github.io/old-blog/?p=349">Deixe um comentário</span></a></span>
				
				
				</div><!-- .entry-meta -->
							</header><!-- .entry-header -->

						<div class="entry-content">

				<p>Olá pessoal! Esse post será sobre objetivo 2.4 da certificação Microsoft 40-487, <strong>Query and manipulate data by using ADO.NET</strong>. Embora já coberto no <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-1-choose-data-access-technologies/" target="_blank">objetivo 1.1</a>, esse objetivo é bem específico sobre o ADO.NET e suas classes, assim como métodos assíncronos.</p>
<h2>Fazendo Queries com Connection, DataReader, Command, DataAdapter e DataSet</h2>
<h4>SqlConnection</h4>
<p>Não há muito segredo sobre a classe SqlConnection. Ela herda de <em>IDbConnection</em> e você deve instanciá-la passando uma connection string, seja inline ou de um arquivo de configuração (web.config).</p>
<p>Todas as connections precisam ser abertas com o método Open e fechadas explicitamente com Close ou num bloco using.</p>
<p><code>using (SqlConnection connection = new SqlConnection("ConnectionStringName"))<br />
{<br />
connection.Open();<br />
}</code></p>
<p>Sempre abra uma conexão num bloco try/catch, pois fatores fora do seu alcança podem impedir que isso aconteça.</p>
<h4>SqlCommand</h4>
<p>A classe SqlCommand, herdeira de <em>IDbCommand</em>, é a responsável por fazer comandos ao banco de dados. Algumas de suas características são:</p>
<ul>
<li>Uma SqlCommand precisa de uma SqlConnection aberta para operar;</li>
<li>Além da propriedade Connection, o único outro item importante é setar a propriedade CommandText, que é o SQL a ser executado. É possível também passar somente o nome de uma stored procedure no lugar do SQL, sendo necessário nesse caso setar a propriedade CommandType para StoredProcedure;</li>
<li>Você nunca deve concatenar valores como string numa query SQL. Instancie a classe SqlParameter e o adicione na propriedade Parameters;</li>
<li>Há muito debate entre stored procedures e &#8220;SQLs dinâmicos&#8221; (queries na propriedade CommandText). O fato é que, sendo parametrizados corretamente, o plano de execução dos SQLs dinâmicos é cacheado, o que pode aumentar a performance e ser menos vulnerável à ataques;</li>
<li>Há várias maneiras de executar um SqlCommand. Você pode usá-lo como input da propriedade SelectCommand de um SqlDataAdapter, chamar ExecuteScalar para retornar um valor ou ExecuteReader para retornar um SqlDataReader;</li>
<li>Cada método de execução tem seu par assíncrono, indicados pelo nome começando com Begin;</li>
<li>É bom chamar o método Dispose de um SqlCommand. Faça isso explicitamente ou faça uso de um bloco using.</li>
</ul>
<p><script src="https://gist.github.com/edneypitta/02cea8020c58df13674d.js"></script></p>
<h4>SqlDataReader</h4>
<p>A classe SqlDataReader, invocada pelo método ExecuteReader de um SqlCommand, é responsável pela obtenção de dados. Você deve fechar explicitamente quaisquer SqlDataReader abertos.</p>
<p>SqlDataReader tem uma característica que você deve ter em mente: ao obter um SqlDataReader pelo método ExecuteReader, o buffer é carregado do banco de dados, mas o stream dos dados <strong>não é feito</strong> até você iterar pelos itens com o método Read. É possível saber se há itens no buffer com a propriedade HasRows, mas não há como saber quantos itens existem sem iterar pelos dados, o que esvazia o buffer no processo. Isso significa que você só pode iterar pelos dados uma única vez.</p>
<p><script src="https://gist.github.com/edneypitta/667e197b6cc90f8e5569.js"></script></p>
<h4>SqlDataAdapter</h4>
<p>SqlDataAdapter é uma classe designada para fazer todas as operações no banco de dados (CRUD).</p>
<p>Na leitura, ela funciona bem diferente do SqlDataReader: um <em>DataSet </em>é populado (com uma mais <em>DataTables</em>), permitindo que você itere quantas vezes quiser &#8211; até com LINQ. Outra diferença é que você pode obter facilmente a quantidade de registros retornados com o Count de uma DataTable.</p>
<p>O método <strong>Fill </strong>é o jeito mais básico de carregar um SqlDataAdapter. Passando um SqlCommand válido, o método conecta ao banco de dados, executa o comando e cria uma DataTable para cada query SELECT. </p>
<p>Cada coluna gera uma DataColumn na DataTable sendo construída. O próprio adapter infere o tipo da DataColumn, de acordo com o schema no banco de dados. Se houver mais de uma coluna com o mesmo nome ou alias, o adapter adiciona um número no final do nome (<em>FirstName1, FirstName2, FirstName3</em>). É possível também chamar o método Fill especificando o valor AddWithKey do enum MissingSchemaAction, resultando na adição de uma primary key e outras contraints existentes no banco de dados. Caso haja mais de uma primary key numa query, você pode criar uma manualmente na DataTable. Com a DataTable e as DataColumns criadas, o adapter cria uma DataRow para cada registro retornado do banco de dados.</p>
<p>Outro método importante é o <strong>Update</strong>. Ele funciona assim: todas as DataRows, quando retornadas, tem o RowState como Unchanged. Você pode alterar o RowState de uma DataRow para Added, Modified ou Deleted. Basicamente, quando o método Update é chamado, ele varre todas as DataRows e, dependendo do RowState, chama o SqlCommand correspondente (InsertCommand, UpdateCommand ou DeleteCommand) do SqlDataAdapter. Para funcionar corretamente, você precisa setar todas essas propriedades. Caso o command não seja encontrado, uma exceção é lançada.</p>
<p>A sintaxe do SqlDataAdapter é assim: (note que o próprio método Fill chama o método Open da SqlConnection, e ele se encarrega de fechá-la. Caso você a abra, a responsabilidade de fechá-la é sua)</p>
<p><script src="https://gist.github.com/edneypitta/687ebc27faa2d2c3ac3f.js"></script></p>
<p>Por último, você pode definir o comportamento de um SqlDataAdapter com algumas propriedades:</p>
<ul>
<li><strong>AcceptChangesDuringFill</strong>: por padrão, o método Fill carrega todas as DataRows com o RowState Unchanged. Se você setar essa propriedade como false, todas as DataRows terão o RowState <strong>Added</strong>;</li>
<li><strong>AcceptChangesDuringUpdate</strong>: como dito anteriormente, o método Update examina o RowState de cada DataRow para saber qual Command invocar. Ao final do método, todos os RowStates são retornados para Unchanged. Setar essa propriedade como false não reseta o RowState; mantém o estado que estava antes do método Fill ser chamado;</li>
<li><strong>UpdateBatchSize</strong>: por padrão, o SqlDataAdapter atualiza uma DataRow por vez. Setando essa propriedade, as atualizações são feitas em grupos, o que diminui as chamadas ao banco de dados;</li>
<li><strong>OnRowUpdating/OnRowUpdated</strong>: eventos na atualização de uma DataRow;</li>
<li><strong>ContinueUpdateOnError</strong>: por padrão, quando há vários comandos a serem executados e um deles lança uma Exception, todos os outros comandos não são feitos. Setando essa propriedade como true, o comando que deu erro é ignorado e os outros comandos são executados normalmente;</li>
<li><strong>FillSchema</strong>: FillSchema usa o SelectCommand para construir o schema do DataTable correspondente, sem popular a tabela.</li>
</ul>
<h2>Fazendo Operações Síncronas e Assíncronas</h2>
<p>Há três métodos de um SqlCommand que têm suas partes assíncronas: BeginExecuteReader, BeginExecuteXmlReader e BeginExecuteNonQuery. Eles são bem fáceis de usar. Basta examinar a propriedade IsCompleted e, quando completo, chamar o método End correspondente:</p>
<p><script src="https://gist.github.com/edneypitta/9e93908367aa1738bfc3.js"></script></p>
<p>Obrigado pela leitura e fiquem ligados no post do objetivo 2.5, <strong><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-5-create-an-entity-framework-data-model/">Create an Entity Framework data model</a></strong>.</p>
<p>Até mais!</p>

				<p><a class="btn btn-default read-more" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-4-query-and-manipulate-data-by-using-ado-net/" title="Certificação Microsoft 70-487: Objetivo 2.4 – Query and manipulate data by using ADO.NET">Leia Mais</a></p>

							</div><!-- .entry-content -->
					</div>
	</div>
</article><!-- #post-## -->

			
				
<article id="post-343" class="post-343 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
	<div class="blog-item-wrap">
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-3-query-data-by-using-linq-to-entities/" title="Certificação Microsoft 70-487: Objetivo 2.3 – Query data by using LINQ to Entities" >
			 				</a>
		<div class="post-inner-content">
			<header class="entry-header page-header">

				<h1 class="entry-title"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-3-query-data-by-using-linq-to-entities/" rel="bookmark">Certificação Microsoft 70-487: Objetivo 2.3 – Query data by using LINQ to Entities</a></h1>

								<div class="entry-meta">
					<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-3-query-data-by-using-linq-to-entities/" rel="bookmark"><time class="entry-date published" datetime="2016-01-18T17:18:06+00:00">18/01/2016</time><time class="updated" datetime="2016-03-01T16:56:54+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>				<span class="comments-link"><i class="fa fa-comment-o"></i><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-3-query-data-by-using-linq-to-entities/#respond"><span class="dsq-postid" data-dsqidentifier="343 https://edneypitta.github.io/old-blog/?p=343">Deixe um comentário</span></a></span>
				
				
				</div><!-- .entry-meta -->
							</header><!-- .entry-header -->

						<div class="entry-content">

				<p>Olá pessoal! Chegamos ao objetivo 2.3 da certificação Developing Microsoft Azure and Web Services, o <strong>Query data by using LINQ to Entities</strong>. </p>
<p>Esse objetivo cobre como 1) fazer queries usando LINQ, 2) IQueryable vs. IEnumerable e 3) logar queries. Vamos lá?</p>
<h4>Fazendo queries usando LINQ</h4>
<p>O objetivo desse ponto é mostrar que é possível utilizar LINQ to Entities de versões antigas do Entity Framework com ObjectContext, assim como se faz com DbContext. </p>
<p>Com ObjectContext, você cria um ObjectQuery que é virtualmente idêntico à aqueles do DbContext. Por exemplo:</p>
<p><code>IQueryable<Account> query = from acct in Context.Accounts<br />
where acct.AccountAlias == "Primary"<br />
select acct;</code></p>
<p>É importante também saber que o ObjectQuery implementa IQueryable, IEnumerable e IListSource.</p>
<h4>IQueryable vs. IEnumerable</h4>
<p>IEnumerable é caracterizado por:</p>
<ul>
<li>Uso em LINQ to Objects e LINQ to XML;</li>
<li>São performados em memória;</li>
<li>São performados no heap.</li>
</ul>
<p>IQueryable são notavelmente diferente na maioria dos casos:</p>
<ul>
<li>Rodam fora do processo;</li>
<li>Suportam diferentes datasources, incluindo remotos;</li>
<li>São usados em LINQ to Entities e LINQ to DataServices.</li>
</ul>
<h4>Logando Queries</h4>
<p>Usando Entity Framework, às vezes se torna necessário você saber exatamente qual a query SQL o framework gerou automaticamente. Por exemplo:</p>
<p><code>IQueryable<Account> Query = from Acct in Context.Accounts<br />
where Acct.AccountAlias == "Primary"<br />
select Acct;</code></p>
<p>Com ObjectQuery (ObjectContext), você pode obter a query fazendo um cast explícito para ObjectQuery e usar o método ToTraceString:</p>
<p><code>String Tracer = (Query as ObjectQuery).ToTraceString();</code></p>
<p>Com DbContext, é possível de maneira similar:</p>
<p><code>String Output = (from Acct in ContextName.ContextSet select Acct).ToString();</code></p>
<p>Isso é tudo para o conteúdo desse objetivo.<br />
Obrigado pela leitura e acompanhe a continuação das postagens da certificação Microsoft 70-487, que será sobre o próximo objetivo <strong>Query and manipulate data by using ADO.NET</strong>.</p>
<p>Até mais!<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-4-query-and-manipulate-data-by-using-ado-net/">Query and manipulate data by using ADO.NET</a></p>

				<p><a class="btn btn-default read-more" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-3-query-data-by-using-linq-to-entities/" title="Certificação Microsoft 70-487: Objetivo 2.3 – Query data by using LINQ to Entities">Leia Mais</a></p>

							</div><!-- .entry-content -->
					</div>
	</div>
</article><!-- #post-## -->

			
				
<article id="post-334" class="post-334 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
	<div class="blog-item-wrap">
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-2-query-and-manipulate-data-by-using-data-provider-for-entity-framework/" title="Certificação Microsoft 70-487: Objetivo 2.2 – Query and manipulate data by using Data Provider for Entity Framework" >
			 				</a>
		<div class="post-inner-content">
			<header class="entry-header page-header">

				<h1 class="entry-title"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-2-query-and-manipulate-data-by-using-data-provider-for-entity-framework/" rel="bookmark">Certificação Microsoft 70-487: Objetivo 2.2 – Query and manipulate data by using Data Provider for Entity Framework</a></h1>

								<div class="entry-meta">
					<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-2-query-and-manipulate-data-by-using-data-provider-for-entity-framework/" rel="bookmark"><time class="entry-date published" datetime="2016-01-18T09:01:02+00:00">18/01/2016</time><time class="updated" datetime="2016-03-01T16:56:46+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>				<span class="comments-link"><i class="fa fa-comment-o"></i><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-2-query-and-manipulate-data-by-using-data-provider-for-entity-framework/#comments"><span class="dsq-postid" data-dsqidentifier="334 https://edneypitta.github.io/old-blog/?p=334">1 Comentário</span></a></span>
				
				
				</div><!-- .entry-meta -->
							</header><!-- .entry-header -->

						<div class="entry-content">

				<p>Olá pessoal! Continuando a série de posts sobre a certificação Microsoft 70-487, vamos ao objetivo 2.2, <strong>Query and manipulate data by using Data Provider for Entity Framework</strong>. Esse é um objetivo bem curto que fala sobre como fazer queries usando o namespace System.Data.EntityClient.</p>
<p>O namespace System.Data.EntityClient é um superset do namespace System.Data, e suas classes operam de forma bem similar. As diferenças se referem ao Entity Framework.</p>
<p>Em todos os cenários de acesso ao banco de dados, uma conexão é necessária. No namespace SqlClient, há a classe SqlConnection. Para o EntityClient, a classe de conexão é a <strong>EntityConnection</strong>. Ela tem três construtores: um vazio (<em>new EntityConnection()</em>), um que recebe uma connection string normal e o terceiro em que você deve especificar informações (metadados) para o EDM. Para fazer isso, a melhor maneira é usar a classe <em>EntityConnectionStringBuilder </em>em conjunto com a classe SqlConnectionStringBuilder:</p>
<p><code>String provider = "System.Data.SqlClient";<br />
String serverName = "localhost";<br />
String databaseName = "dbname";</code></p>
<p><code>SqlConnectionStringBuilder connBuilder = new SqlConnectionStringBuilder();<br />
connBuilder.DataSource = serverName;<br />
connBuilder.InitialCatalog = databaseName;</code></p>
<p><code>EntityConnectionStringBuilder efBuilder = new EntityConnectionStringBuilder();<br />
efBuilder.Provider = Provider;<br />
efBuilder.ProviderConnectionString = connBuilder.ToString();<br />
efBuilder.Metadata = @"*csdl, *ssdl, *msl";<br />
EntityConnection Connection = new EntityConnection(efBuilder.ToString());</code></p>
<p>O resto opera de forma bem igual à uma SqlConnection, como os métodos Open, Close e BeginTransaction.</p>
<p>O <strong>EntityCommand</strong> também trabalha como o SqlCommand. Há os métodos CreateParameter, ExecuteNonQuery, ExecuteReader e ExecuteScalar, por exemplo, e todos eles funcionam como sugerido. Todos eles também têm suas versões Async, onde a única diferença é a presença da propriedade CancellationToken.</p>
<p>Há também a classe <strong>EntityTransaction</strong>, que funciona também de forma idêntica à TransactionScope (explicada <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-3-implement-transactions/" target="_blank">aqui</a>).</p>
<h4>Fazendo Transações</h4>
<p>Há duas opções para se fazer transações diretamente.</p>
<p>A primeira é usando a classe <strong>DbTransaction</strong>. Você a obtém pelo DbContext, no método Database.Connection.BeginTransaction():</p>
<p><code>EntityFrameworkSamplesEntities Context = new EntityFrameworkSamplesEntities();<br />
IDbTransaction TransactionInstance = Context.Database.Connection.BeginTransaction();<br />
try<br />
{<br />
 // Do Something<br />
 Context.SaveChanges();<br />
 TransactionInstance.Commit();<br />
}<br />
catch (EntityCommandExecutionException)<br />
{<br />
 TransactionInstance.Rollback();<br />
}</code></p>
<p>O próximo método, bem mais provável de se encontrar no exame, é pela classe <strong>TransactionScope</strong>. A vantagem dela é que você só precisa chamar o método Complete após SaveChanges; não é necessário nenhum tratamento especial em caso de falha:</p>
<p><code>EntityFrameworkSamplesEntities Context = new EntityFrameworkSamplesEntities();<br />
using (TransactionScope CurrentScope = new TransactionScope())<br />
{<br />
 try<br />
 {<br />
 Context.SaveChanges();<br />
 CurrentScope.Complete();<br />
 }<br />
 catch (EntityCommandExecutionException)<br />
 {<br />
 //Handle the exception as you normally would<br />
 //It won't be committed so transaction wise you're done<br />
 }<br />
 }</code></p>
<p>E isso é tudo para esse objetivo 🙂 O próximo post será sobre o objetivo 2.3, <strong><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-3-query-data-by-using-linq-to-entities/">Query data by using LINQ to Entities</a></strong>.</p>
<p>Até mais!</p>

				<p><a class="btn btn-default read-more" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-2-query-and-manipulate-data-by-using-data-provider-for-entity-framework/" title="Certificação Microsoft 70-487: Objetivo 2.2 – Query and manipulate data by using Data Provider for Entity Framework">Leia Mais</a></p>

							</div><!-- .entry-content -->
					</div>
	</div>
</article><!-- #post-## -->

			
				
<article id="post-321" class="post-321 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
	<div class="blog-item-wrap">
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-1-query-and-manipulate-data-by-using-the-entity-framework/" title="Certificação Microsoft 70-487: Objetivo 2.1 – Query and manipulate data by using the Entity Framework" >
			 				</a>
		<div class="post-inner-content">
			<header class="entry-header page-header">

				<h1 class="entry-title"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-1-query-and-manipulate-data-by-using-the-entity-framework/" rel="bookmark">Certificação Microsoft 70-487: Objetivo 2.1 – Query and manipulate data by using the Entity Framework</a></h1>

								<div class="entry-meta">
					<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-1-query-and-manipulate-data-by-using-the-entity-framework/" rel="bookmark"><time class="entry-date published" datetime="2016-01-15T03:01:48+00:00">15/01/2016</time><time class="updated" datetime="2016-03-01T16:56:36+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>				<span class="comments-link"><i class="fa fa-comment-o"></i><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-1-query-and-manipulate-data-by-using-the-entity-framework/#respond"><span class="dsq-postid" data-dsqidentifier="321 https://edneypitta.github.io/old-blog/?p=321">Deixe um comentário</span></a></span>
				
				
				</div><!-- .entry-meta -->
							</header><!-- .entry-header -->

						<div class="entry-content">

				<p>Olá pessoal! Esse será o post do primeiro objetivo do segundo grande tópico da certificação, o <strong>Querying and manipulating data by using the Entity Framework</strong>. Esse tópico foca especificamente em LINQ e Entity Framework e cobre aproximadamente 20% das questões do exame. Esse primeiro objetivo, <em>Query and manipulate data by using the Entity Framework</em> (que recebe quase o mesmo nome do tópico), cobre aspectos específicos do EF e os componentes que o compõe. Vamos lá?</p>
<h2>Fazendo Queries, Updates e Deletes Usando DbContext</h2>
<p>Fazer queries usando DbContext é bem direto e simples, usando LINQ:</p>
<p><code>var query = (from acct in context.Accounts<br />
 where acct.AccountAlias == "Primary"<br />
 select acct).FirstOrDefault();</code></p>
<p>Após uma entidade ser retornada de uma query, você pode interagir com o objeto como qualquer outro. Você faz quaisquer modificações necessárias e chama o método SaveChanges do context para fazer um update das informações alteradas.</p>
<p>É possível também atualizar um item que você criou usando o método Add ou Attach e chamando o mesmo método SaveChanges para persistir as alterações. É importante entender bem a diferença entre os dois métodos: incluir uma entidade usando Add faz o item ter o EntityState como <em>Added</em>. Pelo objeto não ter valores originais no ObjectStateEntry, quando SaveChanges é chamado, o contexto vai tentar <strong>inserir</strong> a entidade no banco de dados. Attach, por outro lado, cria o item com o EntityState <em>Unchanged</em>. Então o momento que você faz o Attach é muito importante. Se você fizer depois de todas as alterações, <strong>nada vai acontecer</strong>, pois o EntityState vai continuar como Unchanged. Se você fizer o Attach e depois fazer as modificações na entidade, aí sim o context vai fazer o update das propriedades no banco na chamada do SaveChanges.</p>
<p>Para deletar uma entidade do banco, você deve especificar o tipo da entidade usando o método Set e depois chamar o método Remove passando uma query. O item será deletado após a chamada ao SaveChanges.</p>
<p><code>context.Set<Account>().Remove(query);</code></p>
<h2>Deferred Execution e Lazy Loading</h2>
<p>Esse assunto pode ser bem extenso, por isso vamos simplificar bastante aqui.</p>
<p>Veja o seguinte código:</p>
<p><code>var query = from acct in context.Accounts<br />
 where acct.AccountAlias == "Primary"<br />
 select acct;</code></p>
<p>Suponha que no banco de dados há 20 registros com o nome da conta Primary. É lógico pensar que na próxima linha o count da query será 20, certo? <strong>Errado</strong>. Nesse ponto, nada aconteceu em termos de banco de dados. A essência de <em>Deferred Execution</em> (execução adiada) é que somente quando você pede o dado, explicitamente referenciando-o, que o acesso ao banco de dados é de fato feito. O código abaixo, por exemplo, potencialmente dispara muitas idas ao banco de dados:</p>
<p><code>var query = from acct in Context.Accounts<br />
 where acct.AccountAlias == "Primary"<br />
 select acct;<br />
foreach (var currentAccount in query)<br />
{<br />
 Console.WriteLine("Current Account Alias: {0}", currentAccount.AccountAlias);<br />
}</code></p>
<p>Já o código abaixo, por exemplo, ao invés de retornar uma coleção de itens, retorna somente um valor (count). Como é impossível obter esse valor sem ir ao banco de dados, ao chamar Count (ou qualquer função Aggregate como Average e Max), o acesso ao banco de dados é feito imediatamente:</p>
<p><code>var query = (from acct in context.Accounts<br />
 where acct.AccountAlias == "Primary"<br />
 select acct).Count();</code></p>
<p>Resumindo: no conceito de Deferred Execution, usado pelo EF, dados só são recuperados quando necessário.</p>
<p>O Lazy Loading é um conceito parecido com o Deferred Execution, mas aplicado para relacionamentos no banco de dados. </p>
<p>Imagine uma estrutura onde um Bank tem vários Customers, um Customer tem várias Accounts, uma Account tem várias Transactions e uma Transaction tem várias TransactionDetails. Ao obter um Customer para uma atualização simples de dados, você iria querer que todas as Accounts (com todas as Transactions e as TransactionsDetails) fossem retornadas? Provavelmente não.</p>
<p>As opções de Loading são:</p>
<ul>
<li><strong>Lazy Loading</strong>: quando uma query é executada, somente os dados da entidade alvo são retornados. Por exemplo, se houver um relacionamento entre Account e Contact, uma query para Account retornaria inicialmente os dados da Account. Informações da Contact associada seriam retornadas quando uma NavigationProperty fosse acessada ou se você explicitamente pedisse;</li>
<li><strong>Eager Loading</strong>: todos os dados relacionados são retornados. Nesse exemplo, ao fazer uma query para uma Account, os dados da Contact já seriam retornados. Essencialmente, é o oposto de Lazy Loading;</li>
<li><strong>Explicit Loading</strong>: quando Lazy Loading está desabilitado, você pode usá-lo para carregar entidades de forma Lazy explicitamente. O método Load permite que você execute queries individualmente.</li>
</ul>
<p>Você pode achar que Lazy Loading sempre é a melhor opção, mas não se engane. Se você <strong>sabe </strong> quais dados vai usar, o Lazy Loading pode afetar a performance por fazer várias idas as banco de dados ao invés de uma. Se por outro lado você não tiver certeza do número de requisições ao banco de dados e provavelmente não vai utilizar todos os dados retornados, aí sim o Lazy Loading é a melhor opção.</p>
<p>É possível habilitar ou desabilitar o Lazy Loading visualmente ou por código. Pelo Designer, basta ir ao EF Model, depois Properties, e escolher True ou False na propriedade Lazy Loading Enabled. Por código, o DbContext possui uma propriedade Configuration.LazyLoadingEnabled: <code>context.Configuration.LazyLoadingEnabled = true;</code>.</p>
<p>Dê uma olhada no código abaixo:</p>
<p><script src="https://gist.github.com/edneypitta/d7d52d6753dfed406347.js"></script></p>
<p>Se você colocar um breakpoint na linha do primeiro foreach, vai perceber bem a diferença do Lazy Loading. Caso esteja desabilitado, toda a cascata de relacionamento será carregada na primeira ida ao banco de dados. Caso habilitado, você vai notar que as propriedades Customers, Transactions e TransactionDetails não serão carregadas. Elas irão sendo carregadas conforme forem usadas (foreach). Algumas outras operações também fazem com que os relacionamentos sejam carregados, como ToList, ToArray ou ToDictionary.<br />
É importante notar também que se uma função Aggregate for chamada, uma query será executada imediatamente para retornar aquele valor. Então se você chamar o método Count de query.Customers e depois iterar pela lista (foreach), duas chamadas ao banco de dados serão feitas. Iterando primeiro (ou chamando o método ToList), você já saberia o tamanho da lista e não seriam necessárias duas chamadas.</p>
<h2>Criando Compiled Queries</h2>
<p>Usando LINQ, o EF cuida de traduzir a query para a linguagem SQL em tempo de execução, o que leva algum tempo. Por isso, o EF suporta <em>compiled queries</em>, onde ele cacheia o SQL de uma determinada query e somente muda os parâmetros na hora de executá-la. A partir do .NET 4.5, isso é feito automaticamente, mas você pode ainda fazer esse processo manualmente:</p>
<p><code>static readonly Func<MyObjectContext, string, Person> compiledQuery =<br />
            CompiledQuery.Compile<MyObjectContext, string, Person>(<br />
                (ctx, email) => (from p in ctx.People<br />
                                 where p.EmailAddress == email<br />
                                 select p).FirstOrDefault());</code></p>
<p>E usar a query assim: <code>Person p = compiledQuery.Invoke(context, "foo@bar");</code>. É importante o método ser estático para evitar a compilação a cada chamada. Outro ponto é que se a query for modificada, o EF vai precisar recompilá-la. Então o ganho de performance será perdido se você adicionar um Count ou ToList numa query compilada.</p>
<h2>Usando Entity SQL</h2>
<p>O EF permite que você execute queries SQL diretamente no DbContext, com todo o conhecimento do seu model. Outro benefício é o maior controle sobre a query SQL que será executada no banco de dados. Você pode fazer uso do Entity Framework Object Services assim:</p>
<p><code>var queryString = "SELECT VALUE p " +<br />
 "FROM MyEntities.People AS p " +<br />
 "WHERE p.FirstName='John'";<br />
ObjectQuery<Person> people = context.CreateQuery<Person>(queryString);</code></p>
<p>Outro cenário é quando você não precisa do objeto inteiro ou quer trabalhar somente com os valores retornados para ganho de performance. Isso é efetuado através da classe EntityDataReader, bem parecida com a classe DataReader do System.Data. Segue um código de exemplo:</p>
<p><script src="https://gist.github.com/edneypitta/6a77be2cfb173d51c053.js"></script></p>
<p>Isso é tudo para esse objetivo. Obrigado pela leitura e fique de olho no próximo post, que será sobre o objetivo 2.2 da certificação Microsoft 70-487: <strong><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-2-query-and-manipulate-data-by-using-data-provider-for-entity-framework/">Query and manipulate data by using Data Provider for Entity Framework</a></strong>.</p>
<p>Até mais!</p>

				<p><a class="btn btn-default read-more" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-1-query-and-manipulate-data-by-using-the-entity-framework/" title="Certificação Microsoft 70-487: Objetivo 2.1 – Query and manipulate data by using the Entity Framework">Leia Mais</a></p>

							</div><!-- .entry-content -->
					</div>
	</div>
</article><!-- #post-## -->

			
				
<article id="post-298" class="post-298 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
	<div class="blog-item-wrap">
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-6-manipulate-xml-data-structures/" title="Certificação Microsoft 70-487: Objetivo 1.6 – Manipulate XML data structures" >
			 				</a>
		<div class="post-inner-content">
			<header class="entry-header page-header">

				<h1 class="entry-title"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-6-manipulate-xml-data-structures/" rel="bookmark">Certificação Microsoft 70-487: Objetivo 1.6 – Manipulate XML data structures</a></h1>

								<div class="entry-meta">
					<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-6-manipulate-xml-data-structures/" rel="bookmark"><time class="entry-date published" datetime="2016-01-14T01:06:12+00:00">14/01/2016</time><time class="updated" datetime="2016-03-01T16:56:32+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>				<span class="comments-link"><i class="fa fa-comment-o"></i><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-6-manipulate-xml-data-structures/#respond"><span class="dsq-postid" data-dsqidentifier="298 https://edneypitta.github.io/old-blog/?p=298">Deixe um comentário</span></a></span>
				
				
				</div><!-- .entry-meta -->
							</header><!-- .entry-header -->

						<div class="entry-content">

				<p>Olá pessoal! </p>
<p>Continuando a <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-developing-microsoft-azure-and-web-services/" target="_blank">série sobre a certificação Microsoft 70-487</a>, esse post será sobre o objetivo 1.6, <em>Manipulate XML data structures</em>, o último do primeiro tópico da certificação, <em>Accessing data</em>. Vamos lá?</p>
<h2>Lendo, Filtrando, Criando e Modificando Estruturas XML</h2>
<p>XML é um arquivo que estrutura dados em formato de texto baseado em elementos e atributos. Elementos são estruturas que representam um componente de dados, enquanto atributos são propriedades dos elementos.</p>
<p>O primeiro componente de um documento XML é o <em>XML declaration</em>. Esse elemento não é obrigatório e geralmente inclui a versão do XML e o encoding:</p>
<p><code>&lt;?xml version="1.0" encoding="utf-8" ?&gt;</code> </p>
<p>Um XML válido tem os seguintes requerimentos:</p>
<ul>
<li>Deve ter somente um elemento raiz;</li>
<li>Elementos que são abertos devem ser fechados na ordem que foram abertos;</li>
<li>Todos os elementos precisam ser válidos ou bem formados.</li>
</ul>
<p>Considere o seguinte XML. Name, FirstName, MiddleInitial e LastName são elementos, enquanto MiddleName é um atributo do elemento MiddleInitial:</p>
<p><code>&lt;?xml version="1.0" encoding="utf-8" ?&gt;<br />
&lt;Name&gt;<br />
 &lt;FirstName&gt;John&lt;/FirstName&gt;<br />
 &lt;MiddleInitial MiddleName="Quartz"&gt;Q&lt;/MiddleInitial&gt;<br />
 &lt;LastName&gt;Public&lt;/LastName&gt;<br />
&lt;/Name&gt;</code></p>
<p>Existem mais dois elementos que você deve conhecer para o exame: comentários e namespaces. Comentários são definidos dessa forma:</p>
<p><code>&lt;!-- this is a comment about the Name element. Blah blah blah--&gt;</code></p>
<p>Namespaces servem para identificar quem escreveu o XML, geralmente uma empresa. Você pode definir o namespace no elemento raiz como o seguinte:</p>
<p><code>xmlns:Prefix="SomeValueUsuallyACompanyUrl"</code></p>
<p><em>xmlns</em> é a abreviação de XML NameSpace. </p>
<p>Você pode definir também dois namespaces no elemento raiz. Isso é útil quando duas ou mais pessoas (ou empresas) estão escrevendo o mesmo XML, talvez com elementos com o mesmo nome. Por exemplo:</p>
<p><code>&lt;DocumentCore xmlns:johnco=&quot;http://www.yourcompany.com/Companies&quot; xmlns:billco=&quot;http://<br />www.mycompany.com/Customers&quot;&gt;<br /> &lt;johnco:Name&gt;<br /> &lt;johnco:Company&gt;JohnCo&lt;/johnco:Company&gt;<br /> &lt;/johnco:Name&gt;<br /> &lt;billco:Name&gt;<br /> &lt;billco:FirstName&gt;John&lt;/billco:FirstName&gt;<br /> &lt;billco:MiddleInitial&gt;Q&lt;/billco:MiddleInitial&gt;<br /> &lt;billco:LastName&gt;Public&lt;/billco:LastName&gt;<br /> &lt;/billco:Name&gt;<br />&lt;/DocumentCore&gt;</code></p>
<p>Outra opção é definir o namespace no nível de cada elemento:</p>
<p><code>&lt;DocumentCore&gt;<br /> &lt;johnco:Name xmlns:johnco=&quot;http://www.yourcompany.com/Companies&quot;&gt;<br /> &lt;johnco:Company&gt;JohnCo&lt;/johnco:Company&gt;<br /> &lt;/johnco:Name&gt;<br /> &lt;billco:Name xmlns:billco=&quot;http://www.mycompany.com/Customers&quot;&gt;<br /> &lt;billco:FirstName&gt;John&lt;/billco:FirstName&gt;<br /> &lt;billco:MiddleInitial&gt;Q&lt;/billco:MiddleInitial&gt;<br /> &lt;billco:LastName&gt;Public&lt;/billco:LastName&gt;<br /> &lt;/billco:Name&gt;<br />&lt;/DocumentCore&gt;</code></p>
<h2>Manipulando Dados em XML</h2>
<p>Para o exame, você deve se familiarizar com 5 classes que manipulam XML no .NET Framework: <em>XmlWriter</em>, <em>XmlReader</em>, <em>XmlDocument</em>, <em>XPath </em>e <em>LINQ-to-XML</em> (XElement e XDocument). O exame foca mais em LINQ-to-XML por ser mais recente e elegante, então dê atenção especial a esse tópico.</p>
<h4>XmlWriter</h4>
<p>XmlWriter é uma classe fácil, antiga e intuitiva de se entender. Você obtém uma instância pelo método estático Create passando um nome de arquivo e chama os métodos WriteStartDocument, WriteStartElement ou WriteElementString, WriteEndElement e WriteEndDocument. Entenda rapidamente como a classe funciona e o XML gerado:</p>
<p><script src="https://gist.github.com/edneypitta/50ab5e50be3fd99761bb.js"></script></p>
<p><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br />&lt;Customers&gt;<br /> &lt;Customer&gt;<br /> &lt;FirstName&gt;John&lt;/FirstName&gt;<br /> &lt;MiddleInitial&gt;Q&lt;/MiddleInitial&gt;<br /> &lt;LastName&gt;Public&lt;/LastName&gt;<br />&lt;/Customer&gt;<br />&lt;Customer&gt;<br /> &lt;FirstName&gt;Bill&lt;/FirstName&gt;<br /> &lt;MiddleInitial&gt;G&lt;/MiddleInitial&gt;<br /> &lt;LastName&gt;Ryan&lt;/LastName&gt;<br />&lt;/Customer&gt;<br />&lt;Customer&gt;<br /> &lt;FirstName&gt;William&lt;/FirstName&gt;<br /> &lt;MiddleInitial&gt;G&lt;/MiddleInitial&gt;<br /> &lt;LastName&gt;Gates&lt;/LastName&gt;<br /> &lt;/Customer&gt;<br />&lt;/Customers&gt;</code></p>
<h4>XmlReader</h4>
<p>XmlReader é a contraparte do XmlWriter, e é também simples de usar. Você cria um XmlReader passando o nome do arquivo que quer ler, faz um while chamando o método Read e faz sua operação olhando para a propriedade NodeType. Uma rápida olhada no código vai deixar as coisas mais claras:</p>
<p><script src="https://gist.github.com/edneypitta/c881dedae77fc5f78f09.js"></script></p>
<h4>XmlDocument</h4>
<p>XmlDocument é o &#8220;pai&#8221; dos antigos XmlWriter e XmlReader, ainda mais fácil de usar. Para ler um XML, você instancia um novo XmlDocument, chama o método Load apontando para um arquivo ou stream, extrai a lista de nodos (elementos) e itera por eles.</p>
<p><script src="https://gist.github.com/edneypitta/fec394611dd3a2df0d28.js"></script></p>
<p>Para escrever um arquivo XML, basta criar elementos com o método CreateElement e dar AppendChild neles, respeitando a regra de que os elementos abertos primeiro devem ser fechados por último.</p>
<p><script src="https://gist.github.com/edneypitta/aedd2a9c8c8acccd1770.js"></script></p>
<h4>XPath</h4>
<p>XPath, que significa XML Path Language, é um tipo de query para documentos XML. Você obtém a classe XPathNavigator chamando o método CreateNavigator de um XmlDocument. </p>
<p>Considere o seguinte XML:</p>
<p><code>&lt;?xml&#x00a0;version=&quot;1.0&quot;&#x00a0;encoding=&quot;utf-8&quot;&#x00a0;?&gt;<br />&lt;People&gt;<br />&#x00a0;&#x00a0;&lt;Person&#x00a0;firstName=&quot;John&quot;&#x00a0;lastName=&quot;Doe&quot;&gt;<br />&#x00a0;&#x00a0;&#x00a0;&#x00a0;&lt;ContactDetals&gt;<br />&#x00a0;&#x00a0;&#x00a0;&#x00a0;&#x00a0;&#x00a0;&lt;EmailAddress&gt;john@unknown.com&lt;/EmailAddress&gt;<br />&#x00a0;&#x00a0;&#x00a0;&#x00a0;&lt;/ContactDetals&gt;<br />&#x00a0;&#x00a0;&lt;/Person&gt;<br />&#x00a0;&#x00a0;&lt;Person&#x00a0;firstName=&quot;Jane&quot;&#x00a0;lastName=&quot;Doe&quot;&gt;<br />&#x00a0;&#x00a0;&#x00a0;&#x00a0;&lt;ContactDetals&gt;<br /> &#x00a0;&#x00a0;&#x00a0;&#x00a0;&#x00a0;&lt;EmailAddress&gt;jane@unknown.com&lt;/EmailAddress&gt;<br />&#x00a0;&#x00a0;&#x00a0;&#x00a0;&#x00a0;&#x00a0;&lt;PhoneNunmber&gt;001122334455&lt;/PhoneNunmber&gt;<br />&#x00a0;&#x00a0;&#x00a0;&#x00a0;&lt;/ContactDetals&gt;<br />&#x00a0;&#x00a0;&lt;/Person&gt;<br />&lt;/People&gt;</code></p>
<p>Para obter os elementos Person pelo firstName, você usaria o seguinte código:</p>
<p><script src="https://gist.github.com/edneypitta/e37b577bfd3564176a98.js"></script></p>
<h4>LINQ-to-XML</h4>
<p>LINQ-to-XML será bastante coberto no exame pois usa bastante os recursos modernos do .NET Framework como método anônimos, genéricos, tipos nullable e a semântica de query LINQ. É bem importante que você conheça bem a sintaxe do LINQ para o exame como um todo.</p>
<p>As classes estão no namespace System.Xml.Linq. Uma das mais importantes é a classe <em>XElement</em>, que tem 5 construtores:</p>
<ul>
<li>public XElement(XName someName);
</li>
<li>public XElement(XElement someElement);
</li>
<li>public XElement(XName someName, Object someValue);
</li>
<li>public XElement(XName someName, params Object[] someValueset);
</li>
<li>public XElement(XStreamingElement other);<br />
/li>
</ul>
<p>Lembra de como você cria um elemento Customer dentro de Customers com XmlDocument? Veja como se faz com XElement:</p>
<p><code>XElement customers = new XElement("Customers", new XElement("Customer",<br />
 new XElement("FirstName", "John"), new XElement("MiddleInitial", "Q"),<br />
 new XElement("LastName", "Public")));</code></p>
<p>Outra vantagem é que XElement faz o escape automaticamente de caracteres usados na semântica do XML como &lt;, &gt; e &amp;.</p>
<p>Há também a classe <em>XDocument</em>, que representa o documento XML por inteiro. Ela contém as seguintes características:</p>
<ul>
<li>Um objeto <em>XDeclaration </em>quer permite a especificação da versão do XML e do encoding;</li>
<li>Um objeto XElement que serve como raiz;</li>
<li>Objetos de <em>XProcessingInstruction</em> que representam instruções de processamento do XML;</li>
<li>Objetos de <em>XComment</em> que representam comentários.</li>
</ul>
<p>Você pode instanciar um XAttribute da seguinte forma: <code>XAttribute sampleAttribute = new XAttribute("FirstName", "John");</code>.</p>
<p>Namespaces, representados pela classe <em>XNamespace </em>, são usados assim:</p>
<p><code>XNamespace billCo = "http://www.billco.com/Samples";<br />
XElement firstNameBillCo = new XElement(billCo + "FirstName", "John");</code></p>
<p>As coisas começam a ficar mais difíceis nas queries com LINQ, e isso é uma coisa que &#8220;can&#8217;t be emphasized enough&#8221;: é <strong>muito</strong> importante saber LINQ e suas nuances, não só para esse objetivo.</p>
<p>Uma característica é entender a diferença entre os métodos <em>Descendants </em>e <em>Elements </em>de um XContainer. Considere o seguinte código:</p>
<p><script src="https://gist.github.com/edneypitta/afa484f80b713478bb5b.js"></script></p>
<p>O output de ambos os casos é 3. Inicialmente eles podem parecer idênticos, mas eles têm uma grande diferença. O método Descendants nesse caso procura por elementos Customer em <strong>qualquer nível abaixo do XContainer que o chamou</strong>, nesse exemplo o Root. Já o Elements procura por elementos Customer apenas <strong>um nível abaixo do XContainer</strong>. Nesse caso ele encontra os três elementos Customer pois o Root é o elemento Customers. Se a estrutura fosse como abaixo, por exemplo, o método Elements não encontraria nenhum elemento Customer:</p>
<p><code>&lt;Root&gt;<br />&lt;Customers&gt;<br />&lt;Customer&gt;&lt;FirstName&gt;John&lt;/FirstName&gt;&lt;/Customer&gt;<br /> &lt;Customer&gt;&lt;FirstName&gt;Bill&lt;/FirstName&gt;&lt;/Customer&gt;<br /> &lt;Customer&gt;&lt;FirstName&gt;Joe&lt;/FirstName&gt;&lt;/Customer&gt;<br />&lt;/Customers&gt;<br />&lt;/Root&gt;</code></p>
<h4>Manipulação Avançada de XML</h4>
<p>Nessa seção do objetivo, a ideia é ter mais questões de manipulações e queries com LINQ-to-XML. </p>
<p>Um ponto a destacar é que você deve conhecer a classe <em>XmlConvert</em> para dar escape de caracteres especiais se você não estiver usando uma classe que faz isso para você, como XElement. XmlConvert é irmã da classe Convert, focada para XML. Ela automaticamente faz o escape de caracteres reservados e provê vários métodos de conversão para arquivos XML. </p>
<p>A lista abaixo contém os métodos não óbvios como ToInt32, ToDateTime, etc. e seus comportamentos:</p>
<ul>
<li><strong>DecodeName</strong>: faz o decode de um nome encodado;</li>
<li><strong>EncodeName</strong>: faz o encode de uma string para que possa ser usada como um nome de nodo XML;</li>
<li><strong>EncodeLocalName</strong>: faz o mesmo de EncodeName, com uma diferença: encoda também o caracter &#8220;:&#8221;, assegurando que o nome pode ser usado em elementos que contenham namespace;</li>
<li><strong>EncodeNmToken</strong>: retorna um nome válido para um nodo de acordo com a <em>XML Language Spec</em>;</li>
<li><strong>IsStartNCNameChar</strong>: determina se o parâmetro não é o caracter &#8220;:&#8221;;</li>
<li><strong>IsPublicIdChar</strong>: determina se o parâmetro é um identificador XML público (algumas magic strings que existem por legado);</li>
<li><strong>ToDateTimeOffset</strong>: converte para DateTimeOffset, um DateTime com identificador em relação ao UTC.</li>
</ul>
<p>Segue um código de aplicação dos métodos mais relevantes da classe XmlConvert (DecodeName, EncodeName e EncodeLocalName):</p>
<p><script src="https://gist.github.com/edneypitta/f7c1bfb759cc0d8bce0a.js"></script></p>
<p>Um último ponto desse objetivo como um todo é que você pode usar diferentes classes do .NET Framework para lidar com o mesmo XML. Você pode juntar implementações onde julgar necessário; usar uma metodologia não te força a usá-la até o fim.</p>
<p>Esse foi o último objetivo do primeiro grande tópico da certificação, <em>Accessing Data</em>. O próximo post será sobre o primeiro objetivo do segundo tópico da certificação, <strong><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-2-1-query-and-manipulate-data-by-using-the-entity-framework/">Querying and manipulating data by using the Entity Framework</a></strong>.</p>
<p>Obrigado pela leitura e até mais!</p>

				<p><a class="btn btn-default read-more" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-6-manipulate-xml-data-structures/" title="Certificação Microsoft 70-487: Objetivo 1.6 – Manipulate XML data structures">Leia Mais</a></p>

							</div><!-- .entry-content -->
					</div>
	</div>
</article><!-- #post-## -->

			
				
<article id="post-285" class="post-285 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
	<div class="blog-item-wrap">
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-5-create-and-implement-wcf-data-services-service/" title="Certificação Microsoft 70-487: Objetivo 1.5 – Create and implement a WCF Data Services service" >
			 				</a>
		<div class="post-inner-content">
			<header class="entry-header page-header">

				<h1 class="entry-title"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-5-create-and-implement-wcf-data-services-service/" rel="bookmark">Certificação Microsoft 70-487: Objetivo 1.5 – Create and implement a WCF Data Services service</a></h1>

								<div class="entry-meta">
					<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-5-create-and-implement-wcf-data-services-service/" rel="bookmark"><time class="entry-date published" datetime="2016-01-13T01:05:30+00:00">13/01/2016</time><time class="updated" datetime="2016-03-01T16:56:26+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>				<span class="comments-link"><i class="fa fa-comment-o"></i><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-5-create-and-implement-wcf-data-services-service/#respond"><span class="dsq-postid" data-dsqidentifier="285 https://edneypitta.github.io/old-blog/?p=285">Deixe um comentário</span></a></span>
				
				
				</div><!-- .entry-meta -->
							</header><!-- .entry-header -->

						<div class="entry-content">

				<p>A discussão sobre WCF Data Services no <a href="https://edneypitta.github.io/old-blog/certificao-microsoft-70-487-objetivo-1-1-choose-data-access-technologies-parte-3-wcf-data-services/" target="_blank">objetivo 1.1</a> foi curta porque há um objetivo específico para ele, o Create and implement a WCF Data Services service, que será coberto nesse post. </p>
<p>Esse objetivo cobre como endereçar recursos, criar uma query, acessar formatos de carga (incluindo JSON) e trabalhar com interceptores e operadores de serviço. Vamos lá?</p>
<h2>Endereçando Recursos</h2>
<p>Para criar um WCF Data Service, basicamente você deve seguir os seguintes passos:</p>
<ul>
<li>Criar uma aplicação ASP.NET (para hostear o Data Service);</li>
<li>Usar o EF para criar seu EntityModel;</li>
<li>Adicionar um WCF Data Service;</li>
<li>Especificar um tipo para o serviço (que é o nome do model container do projeto do EF);</li>
<li>Habilitar acesso ao Data Service configurando explicitamente algumas propriedades do <em>DataServiceConfiguration</em> (SetEntitySetAccessRule, SetServiceOperationAccessRule e DataServiceBehavior)</li>
</ul>
<p>Quando você adicionar um WCF Data Service, você verá classes geradas assim: <code>public class ExamSampleService : DataService<Nome do Model></code>. Essas classes herdam de <em> System.Data. Services.DataService</em>, que recebem um tipo genérico. O código gerado terá também o método <em>InitializeService</em> com alguns comentários que ajudam na sua configuração:</p>
<p><code>// This method is called only once to initialize service-wide policies.<br />
public static void InitializeService(DataServiceConfiguration config) {<br />
// TODO: set rules to indicate which entity sets and service operations are visible, updatable, etc.<br />
// Examples:<br />
// config.SetEntitySetAccessRule("MyEntityset", EntitySetRights.AllRead);<br />
// config.SetServiceOperationAccessRule("MyServiceOperation", ServiceOperationRights.All);  config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V2;<br />
}</code></p>
<p>Como já citado, é importante se familiarizar com os métodos <em>SetEntitySetAccessRule </em>e <em>SetServiceOperationAccessRule </em>e a propriedade <em>DataServiceBehavior.MaxProtocolVersion</em>.</p>
<h4>SetEntitySetAccessRule</h4>
<p>Esse método recebe dois parâmetros: uma string com o nome do EntitySet e um enum EntitySetRights. Como o enum é decorado com Flags, você pode passar mais de um valor dessa forma: <code>config.SetEntitySetAccessRule("Courses", EntitySetRights.AllRead | EntitySetRights.WriteMerge);</code>. Os possíveis valores desse enum são:</p>
<ul>
<li><strong>None</strong>: todos os acessos são revogados;</li>
<li><strong>ReadSingle</strong>: um item pode ser lido;</li>
<li><strong>ReadMultiple</strong>: sets de dados podem ser lidos;</li>
<li><strong>WriteAppend</strong>: novos itens podem ser adicionados;</li>
<li><strong>WriteReplace</strong>: dados podem ser atualizados;</li>
<li><strong>WriteDelete</strong>: dados podem ser deletados;</li>
<li><strong>WriteMerge</strong>: dados podem ser mergeados;</li>
<li><strong>AllRead</strong>: tudo pode ser lido;</li>
<li><strong>AllWrite</strong>: tudo pode ser escrito;</li>
<li><strong>All</strong>: todas as operações são permitidas.</li>
</ul>
<h4>SetServiceOperationAccessRule</h4>
<p>Esse método dá permissões para uma ServiceOperation e funciona da mesma forma que o método SetEntitySetAccessRule, mas o enum é um ServiceOperationRights. Os valores desse enum são:</p>
<ul>
<li><strong>None</strong>: todos os acessos são revogados;</li>
<li><strong>ReadSingle</strong>: um item pode ser lido;</li>
<li><strong>ReadMultiple</strong>: sets de dados podem ser lidos;</li>
<li><strong>AllRead</strong>: um e vários itens podem ser lidos;</li>
<li><strong>All</strong>: todos os direitos são garantidos;</li>
<li><strong>OverrideEntitySetRights</strong>: indica se sobrescreve os valores configurados em SetEntitySetAccessRule.</li>
</ul>
<h4>DataServiceBehavior.MaxProtocolVersion</h4>
<p>Essa propriedade indica qual versão do protocolo OData será usado no serviço. Os possíveis valores do enum DataServiceProtocolVersion são V1 e V2.</p>
<h2>Criando Uma Query</h2>
<p>Uma das principais vantagens do WCF Data Services é que seus recursos são endereçáveis por URIs via OData, e você pode fazer queries nas URIs de uma forma bem simples.</p>
<p>Suponha que você criou um WCF Data Service com o nome ExamPrepService baseado num Entity Model que tem tópicos, questões e respostas como entidades.</p>
<p>Para obter todos os registros de uma entidade, a query <em>Service/EntitySetName</em> pode ser usada. Para obter todos os tópicos do serviço, por exemplo, a seguinte query pode ser usada:<br />
<code>http://servicehost/ExamPrepService.svc/Topics</code></p>
<p>A query <em>Service/EntitySetName(&#8216;KeyValue&#8217;)</em> retorna a entidade que tem uma key com o valor passado. Por exemplo, para obter o tópico que tem o nome First, a query fica <code>http://servicehost/ExamPrepService.svc/Topics('First')</code>.</p>
<p>Se você precisa somente da propriedade Description, a query fica <code>http://servicehost/ExamPrepService.svc/Topics('First')/Description</code>. Se quiser somente o valor primitivo e não o XML, basta adicionar /$value no final: <code>http://servicehost/ExamPrepService.svc/Topics('First')/Description/$value</code>.</p>
<p>As queries funcionam bem com relacionamentos, se esses estiverem definidos no Entity Model. Para obter todas as Answers da Question com a key 1, por exemplo, a seguinte query deve ser usada:<br />
<code>http://servicehost/ExamPrepService.svc/Questions('1')/Answers</code></p>
<p>O caminho inverso também é possível: <code>http://servicehost/ExamPrepService.svc/Answers('1:4')/Question</code>.</p>
<p>Até agora, só filtramos os resultados pela key da entidade. Mas o protocolo OData e o WCF Data Service oferecem várias opções de query que se traduzem em queries SQL. É bem importante entender o efeito de todos eles no resultado.</p>
<ul>
<li><strong>$orderby</strong>: define uma ordem para o resultado. Uma ou mais propriedades podem ser usadas, separadas por vírgula: <code>/Questions?$orderby=Id,Description</code>;</li>
<li><strong>$top</strong>: define quantos resultados serão retornados: <code>/Questions?$top=5</code></li>
<li><strong>$skip</strong>: indica quantos registros devem ser ignorados. Suponha que há 30 tópicos, mas você quer ignorar os 10 primeiros e os 10 últimos. A query fica assim: <code>/Questions?$skip=10&$top=10</code>;</li>
<li><strong>$filter</strong>: especifica uma ou mais condições: <code>/Questions?$filter=Id gt 5</code>;</li>
<li><strong>$expand</strong>: indica quais entidades relacionadas serão retornadas: <code>/Questions?$expand=Answers</code>;</li>
<li><strong>$select</strong>: por padrão, todas as propriedades de uma entidade são retornadas. Usando $select, você pode especificar quais propriedades serão retornadas separando por vírgula: <code>/Questions&$select=Id,Text,Description,Author</code>;</li>
<li><strong>$inlinecount</strong>: retorna o número de registros retornados no elemento &lt;count&gt;: <code>/Questions?$inlinecount=allpages</code>.</li>
</ul>
<p>Você também pode executar queries por meio de código usando a classe <em>DataServiceQuery</em>:</p>
<p><code>String ServiceUri = "http://servicehost/ExamPrepService.svc";<br />
ExamServiceContext ExamContext = new ExamServiceContext(new Uri(ServiceUri); DataServiceQuery<Questions> = ExamContext.Question<br />
.AddQueryOptions("$filter", "id gt 5")<br />
.AddQueryOptions("$expand", "Answers");</code></p>
<h4>Acessando Formatos De Carga</h4>
<p>o WCF Data Service dá suporte aos formatos Atom e JSON de forma fácil. </p>
<p>Basta usar a opção $format na query com o valor atom ou json. Caso esteja consultando via WebClient ou queira especificar isso em um request header, funciona da mesma maneira. Para JSON, coloque o header Content-Type para <em>application/json</em>. Para Atom, <em>application/atom+xml</em>.</p>
<h4>Trabalhando Com Interceptor e Service Operator</h4>
<p>O WCF Data Service permite que você intercepte um request para prover uma lógica customizada. </p>
<p>Há dois tipos de Interceptors: <em>ChangeInterceptor</em>, que serve para interceptar operações NON-Query, e <em>QueryInterceptor</em>, que intercepta operações de Query.</p>
<p>ChangeInterceptors têm retorno nulo e aceitam dois parâmetros: o tipo da entidade e um UpdateOperations, que referencia o request. A definição de um método ChangeInterceptor fica assim:</p>
<p><code>[ChangeInterceptor("Topics")]<br />
public void OnChangeTopics(Topic topic, UpdateOperations operations)<br />
</code></p>
<p>QueryInterceptors são decorados com QueryInterceptor e retornam uma Expression<Func<T, Boolean>>, que servem como filtro para a entidade. A assinatura fica assim:</p>
<p><code>[QueryInterceptor("Topics")]<br />
public Expression<Func<Topic, bool>> FilterTopics(){}</code></p>
<p>A dica para o exame é que, para identificar se um método é ChangeInterceptor ou QueryInterceptor, basta olhar para o tipo do retorno.<br />
Para saber qual Interceptor deve ser implementado para fazer alguma coisa, é necessário saber o comportamento e determinar se é uma operação NON-Query ou Query. Por exemplo, <em>DeleteTopics </em>seria um ChangeInterceptor; já um método <em>GetAdvancedTopics </em>seria um QueryInterceptor.</p>
<p>Qualquer dúvida, fique à vontade para fazê-la nos comentários.<br />
Fique ligado para o post do próximo objetivo, <strong><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-6-manipulate-xml-data-structures/">Manipulate XML data structures</a></strong>.</p>
<p>Até mais!</p>

				<p><a class="btn btn-default read-more" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-5-create-and-implement-wcf-data-services-service/" title="Certificação Microsoft 70-487: Objetivo 1.5 – Create and implement a WCF Data Services service">Leia Mais</a></p>

							</div><!-- .entry-content -->
					</div>
	</div>
</article><!-- #post-## -->

			
				
<article id="post-268" class="post-268 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
	<div class="blog-item-wrap">
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-4-implement-data-storage-in-windows-azure/" title="Certificação Microsoft 70-487: Objetivo 1.4 &#8211; Implement data storage in Windows Azure" >
			 				</a>
		<div class="post-inner-content">
			<header class="entry-header page-header">

				<h1 class="entry-title"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-4-implement-data-storage-in-windows-azure/" rel="bookmark">Certificação Microsoft 70-487: Objetivo 1.4 &#8211; Implement data storage in Windows Azure</a></h1>

								<div class="entry-meta">
					<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-4-implement-data-storage-in-windows-azure/" rel="bookmark"><time class="entry-date published" datetime="2016-01-10T16:59:54+00:00">10/01/2016</time><time class="updated" datetime="2016-03-01T16:55:54+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>				<span class="comments-link"><i class="fa fa-comment-o"></i><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-4-implement-data-storage-in-windows-azure/#comments"><span class="dsq-postid" data-dsqidentifier="268 https://edneypitta.github.io/old-blog/?p=268">1 Comentário</span></a></span>
				
				
				</div><!-- .entry-meta -->
							</header><!-- .entry-header -->

						<div class="entry-content">

				<p>Olá pessoal! Vamos ao primeiro (e um dos poucos) objetivo que fala de Azure na certificação de Azure, o Implement data storage in Windows Azure. Para acompanhar os objetivos já postados, <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-developing-microsoft-azure-and-web-services/" target="_blank">clique aqui</a>.</p>
<p>O primeiro tópico desse objetivo é sobre armazenamento de dados. Comparado com mecanismos de armazenamento de dados tradicionais, as soluções do Azure oferecem um suporte bem parecido com o que já existe. Mas é claro que coisas novas geram mudanças, ainda mais com um paradigma mais recente que é a nuvem. Por exemplo, acesso à internet é fundamental para que qualquer armazenamento no Azure funcione.</p>
<p>As opções de armazenamento de dados no Azure são: <strong>Local Storage</strong>; <strong>Blob</strong>, <strong>Table </strong>e <strong>Queue </strong>(fazendo parte do Windows Azure Storage); e <strong>SQL Database</strong>. Para o exame, é bem provável que você encontre alguma pergunta onde um cenário é dado e você deve escolher quais desses itens resolveriam o problema. Vamos às explicações básicas: quando você ler vídeo, áudio ou imagem, a pergunta está se tratando de Blob. Quando é algum dado estruturado, pode ser Table ou SQL Database, se a estrutura for relacional. Queue se trata de garantir um mecanismo de envio de mensagens em fila. Local Storage é um armazenamento temporário igual a um sistema de arquivos. Vamos nos aprofundar na implementação desses itens.</p>
<h2>Blob Storage</h2>
<p>A estrutura de Blob foi feita para armazenamento de dados binários, como os já mencionados vídeo, áudio e imagem. É possível também armazenar um arquivo Excel como binário sem nenhum problema. Um dos principais benefícios é que as informações são acessíveis via HTTP. Basta ter a URL e você pode acessar uma imagem, por exemplo. Os arquivos podem ter o tamanho de até 100 TB. Acho que já deu para entender o conceito, mas as coisas ideais de serem armazenadas em Blob são: imagens que podem ser vistas diretamente no browser, documentos, backups de banco de dados, vídeos e áudios.</p>
<p>A estrutura do Blob funciona assim: no nível mais alto está a Storage Account. Dentro dela temos Containers e, dentro dos Containers, Blobs. Há o limite de 100 TB em uma Storage Account, porém ela pode ter quantos Containers forem necessários. Pense em um Container como um subdiretório para organizar os blobs (a diferença é que Containers não podem conter Containers). Um Blob é um arquivo, sem restrição de formato. Há duas categorias de Blobs: Block (limite de 200 GB) e Page (limite de 1 TB).</p>
<p>Você pode acessar um Blob de duas formas. A primeira, como citado, é por uma URL HTTP. A URL tem o seguinte formato: <em>http://<storage account name>.blob.core.windows.net/{container}/{blob}</em>. </p>
<p>A segunda maneira é pela API do Azure SDK. Você deve adicionar uma referência ao assembly <em>Microsoft.WindowsAzure.Storage.dll</em>. A Storage Account é representada pela classe <em>CloudStorageAccount</em>. Para instanciá-la, você pode usar um de seus dois construtores. O primeiro recebe uma <em>StorageCredentials </em>e três URIs representando o endpoint do Blob, Queue e Storage, nessa ordem. O segundo construtor recebe uma StorageCredentials e um bool que indica se será utilizado HTTPS. Vamos ao código:</p>
<p><script src="https://gist.github.com/edneypitta/9c363220a2822b98be39.js"></script></p>
<p>Outra maneira (bem melhor) de instanciar a classe CloudStorageAccount é usando o método estático <em>Parse </em>ou <em>TryParse</em>, que possui dois overloads: é possível usar a classe <em>CloudConfigurationManager </em>e chamar o método GetSetting(), que obtém a informação do arquivo .CSCFG do seu projeto Windows Azure Cloud, ou passar somente uma connection string no formato certo (<em>&lt;add name=&#8221;StorageConnection&#8221; connectionString=&#8221;DefaultEndpointsProtocol=https;AccountName=ACCOUNT_NAME_GOES_HERE;AccountKey=ACCOUNT_KEY_GOES_HERE&#8221; /&gt;</em>).</p>
<p><script src="https://gist.github.com/edneypitta/b7f3c27b8c5292495305.js"></script></p>
<p>Depois de instanciada a classe CloudStorageAccount, você precisa criar um <em>CloudBlobClient </em>e obter uma referência ao <em>CloudBlobContainer</em>. Lembre-se de que há dois tipos de Blobs e cada um tem seu método para obter a referência (<em>GetBlockBlobReference </em>e <em>GetPageBlobReference</em>). </p>
<p>Do Container é possível obter a referência para o blob desejado e salvar o conteúdo do arquivo chamando o método <em>UploadFromStream</em>. Há outros dois métodos para realizar o upload (<em>UploadFromByteArray </em>e <em>UploadFromFile</em>). Todos eles sobrescrevem os dados se eles já existirem e têm sua versão assíncrona (com Async no final do nome), o que é ideal para fazer o upload de Blobs grandes. É também recomendado envolver a chamada de qualquer Upload em um try/catch para tratar quaisquer erros de rede. Para fazer o download de um Blob, basta chamar o método <em>DownloadToStream</em>. Para deletar um Blob, há os métodos <em>Delete </em>e <em>DeleteIfExists</em>.</p>
<p>A criação padrão de um Container é com acesso privado. Você pode mudar a permissão chamando o método <em>SetPermissions </em>de um CloudBlobContainer, passando um <em>BlobContainerPermissions </em>com <em>PublicAccess </em>habilitado, por exemplo. Você pode também distribuir assinaturas de acesso temporárias com o método <em>GetSharedAccessSignature</em>, tanto de um Container quanto de um Blob.</p>
<h2>Table e Queue Storage</h2>
<p>Uma Table storage serve armazenar dados não relacionais, como os bancos de dados NoSQL (CouchDB ou MongoDB, por exemplo). Uma Queue storage serve para armazenar mensagens no esquema de fila, onde o primeiro item que entra é o primeiro a sair (FIFO, First In First Out). Queues são úteis em sistemas de entrega de mensagens ou longos processamentos.</p>
<p>As APIs de Table e Queue são bem parecidas com as do Blob. Você instancia a classe CloudStorageAccount, chama o método CreateCloudTableClient ou CreateCloudQueueClient e <em>voilà</em>. Tables e Queues são sempre privadas.</p>
<p>Queues são mais simples porque não há métodos de busca. Além de poder obter uma quantidade aproximada de itens na fila, basicamente há métodos para colocar e obter mensagens da fila (push-and-pop). Um aspecto interessante é que obter uma mensagem da fila não a remove completamente, só a deixa invisível por um período de tempo (1 minuto por padrão). Se seu processamento demorar mais do que esse tempo, você deve atualizar o status da mensagem como escondida para que outros processos não a vejam na fila. Após terminar seu processamento, aí sim você pode deletar a mensagem da fila.</p>
<p>Tables são um pouco mais interessantes pois é possível interagir com os dados. O jeito principal de obter um registro é executar uma <em>TableOperation</em>, mas você pode obter vários registros com uma <em>TableQuery</em>. Vamos a um trecho de código que adiciona um registro, obtém esse registro e o deleta. Note que a classe <em>Record </em>herda de <em>TableEntity</em>, sendo possível criar classes que representam os dados na Table.</p>
<p><script src="https://gist.github.com/edneypitta/fc10682479610341beea.js"></script></p>
<h2>Distribuição de Dados Usando Windows Azure Content Delivery Network (CDN)</h2>
<p>O Windows Azure Content Delivery Network (CDN) é uma maneira de cachear conteúdos estáticos (Blobs). A ideia é usar uma localidade próxima ao client para melhorar a performance e largura de banda. Os dois principais benefícios, segundo a MSDN, são:</p>
<ul>
<li>Melhorar a performance para usuários que estão longe da fonte de conteúdo e estão utilizando aplicações que necessitam de muitas requisições;</li>
<li>Escalar a distribuição para lidar melhor com uma alta carga instantânea, como um lançamento de produto.</li>
</ul>
<p>Para usar o CDN, você deve habilitar no portal do Azure. Depois, o CDN vai funcionar assim: quando um request for feito para um Blob, ele vai redirecionar transparentemente o request para a localização mais próxima, para evitar uma viagem muito grande. O primeiro request será feito normalmente, mas os próximos serão cacheados naquela região. O tempo de expiração é importante, pois como os itens são cacheados, alguns problemas podem acontecer caso o item seja atualizado frequentemente. O que controla o tempo de expiração é a configuração Time To Live (TTL) no portal.</p>
<p>Para deixar um conteúdo disponível para CDN, ele deve estar em um container público e disponível para acesso anônimo. Containers públicos podem ser setados via API, como citado acima. A propriedade PublicAccess deve ser configurada como <em>BlobContainerPublicAccessType.Container</em>.</p>
<p>Com tudo configurado, basta acessar o Blob. A URL tradicional vai funcionar normalmente (<em>http://<storage account name>.blob.core.windows.net/{container}/{blob}</em>), mas uma nova URL ficará disponível pelo CDN: <em>http://<storage account name>.vo.msecnd.net/{container}/{blob}</em>.</p>
<p>Só relembrando: quanto mais um item for dinâmico, menos provável que ele seja um bom candidato para usar CDN, por causa do cache.</p>
<h2>Windows Azure Caching</h2>
<p>Cacheamento no nível do Windows Azure é bem diferente do que temos em nível de aplicação, como <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-2-implement-caching/" target="_blank">nesse objetivo</a>. Esse cacheamento é <em>role-based</em>, ou seja, disponível em qualquer role no Windows Azure.</p>
<p>Há dois mecanismos: <em>dedicated topology</em> e <em>co-located topology</em>. Em uma dedicated topology, você define uma role que será especificamente designada para lidar com cache, por exemplo, toda a memória de uma Worker Role. Em um cenário de co-located topology, apenas parte dos recursos podem ser utilizado para cache. Caso você tenha 4 Worker Roles, por exemplo, pode usar 25% de cada para lidar com cache.</p>
<p>Existe também um serviço opcional chamado Windows Azure Shared Caching. Diferente dos anteriores, ele existe em nível de serviço, e não de role.</p>
<h2>Lidando Com Exceções Usando Retries (SQL Database)</h2>
<p>SQL Database, sendo um banco de dados na nuvem, tem vários benefícios como escalabilidade e facilidade de configuração. Uma desvantagem é que, com a distância física entre o servidor de aplicação e o de banco de dados, a latência aumenta, podendo causar timeouts na conexão com o banco. Como esse erro é temporário, faz sentido ter uma lógica de retentativa (retry) nas conexões com o banco de dados.</p>
<p>O Azure oferece um framework para implementação de lógicas de retentativa. Segue um código de retentativa em deadlocks e timeouts com ADO.NET:</p>
<p><script src="https://gist.github.com/edneypitta/00283d023902f079210e.js"></script></p>
<p>Isso é tudo para esse objetivo 🙂 Obrigado pela leitura e fique ligado no post do próximo objetivo, <strong><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-5-create-and-implement-wcf-data-services-service/">Create and implement a WCF Data Services service</a></strong>.<br />
Até lá!</p>

				<p><a class="btn btn-default read-more" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-4-implement-data-storage-in-windows-azure/" title="Certificação Microsoft 70-487: Objetivo 1.4 &#8211; Implement data storage in Windows Azure">Leia Mais</a></p>

							</div><!-- .entry-content -->
					</div>
	</div>
</article><!-- #post-## -->

			
				
<article id="post-255" class="post-255 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
	<div class="blog-item-wrap">
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-3-implement-transactions/" title="Certificação Microsoft 70-487: Objetivo 1.3 – Implement transactions" >
			 				</a>
		<div class="post-inner-content">
			<header class="entry-header page-header">

				<h1 class="entry-title"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-3-implement-transactions/" rel="bookmark">Certificação Microsoft 70-487: Objetivo 1.3 – Implement transactions</a></h1>

								<div class="entry-meta">
					<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-3-implement-transactions/" rel="bookmark"><time class="entry-date published" datetime="2016-01-07T22:43:42+00:00">07/01/2016</time><time class="updated" datetime="2016-03-01T16:55:48+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>				<span class="comments-link"><i class="fa fa-comment-o"></i><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-3-implement-transactions/#respond"><span class="dsq-postid" data-dsqidentifier="255 https://edneypitta.github.io/old-blog/?p=255">Deixe um comentário</span></a></span>
				
				
				</div><!-- .entry-meta -->
							</header><!-- .entry-header -->

						<div class="entry-content">

				<p>Olá pessoal! Nesse post vou falar sobre o objetivo 1.3 do exame de certificação Microsoft 40-487, Implement transactions. Para acompanhar desde o começo e ver os primeiros posts, <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-developing-microsoft-azure-and-web-services/" target="_blank">clique aqui</a>.</p>
<p>Para o exame, é necessário que você saiba características gerais de transações e como implementá-las com ADO.NET e Entity Framework. Vamos lá?</p>
<h2>Entendendo Transações</h2>
<p>Basicamente, transações servem para fazer os dados do banco de dados serem consistentes. Elas são necessárias em caso de falha no meio de uma execução de comandos, servindo para que <strong>todos </strong>eles sejam revertidos. Por exemplo, ao tentar fazer a inserção de uma <em>Account</em> e depois uma <em>AccountDetails</em>, as duas inserções devem ser feitas com sucesso para que não haja um registro de AccountDetails sem Account e vice-versa. Entender esse conceito é fundamental para esse objetivo.</p>
<p>Outro aspecto importante de transações é se elas são <strong>simples</strong> ou <strong>distribuídas</strong>. Essencialmente, uma transação simples envolve apenas um banco de dados, enquanto uma distribuída envolve diversos bancos de dados, provavelmente de aplicações diferentes. Uma limitação da classe System.Data.SqlClient.SqlTransaction é que ela só trabalha com bancos de dados SQL Server.</p>
<p>Há também o conceito de <strong>nível de isolamento</strong> (<em>isolation level</em>) de uma transação. O enum <em>IsolationLevel</em> serve para controlar o comportamento de lock na execução de um comando. Esse enum existe em dois namespaces (System.Data e System.Transaction), mas ambos fazem a mesma coisa e têm os mesmos valores. A diferença apenas é que eles trabalham com as classes dos seus respectivos namespaces. O IsolationLevel pode ser mudado durante a execução da transação sem problemas. Vamos ao valores e comportamento deles:</p>
<ul>
<li><strong>Unspecified</strong>: Não determinado. O nível de isolamento será determinado pelo driver do banco de dados.</li>
<li><strong>Chaos</strong>: As alterações pendentes de transações mais altamente isoladas não podem ser substituídas. Esse valor não é suportado no SQL Server ou Oracle, por isso tem uma utilização bem limitada.</li>
<li><strong>ReadUncommitted</strong>: Nenhum <em>shared lock</em> é emitido. Isso implica que a leitura pode ser imprecisa, o que geralmente não é desejado.</li>
<li><strong>ReadCommitted</strong>: Emite shared locks nas leituras. Isso evita leituras imprecisas, mas os dados ainda podem ser mudados antes do fim da execução da transação. Pode resultar em <a href="http://stackoverflow.com/questions/11043712/what-is-difference-between-non-repeatable-read-and-phantom-read" target="_blank"><em>nonrepeatable reads</em> ou <em>phantom data</em></a>.</li>
<li><strong>RepeatableRead</strong>: Locks são colocados em todos os dados usados na query, o que previne quaisquer alterações durante a execução da transação. Isso acaba com o problema de nonrepeatable read, mas phantom data ainda pode ocorrer.</li>
<li><strong>Serializable</strong>: Um <em>range lock</em> é colocado em um específico DataSet, o que previne quaisquer inserções ou alterações até que a transação termine. Deve ser usado rapidamente.</li>
<li><strong>Snapshot</strong>: Uma cópia dos dados é feita, então uma execução de transação pode ler enquanto outra pode modificar os mesmos dados. Não é possível ver os dados de outras execuções de transações, mesmo rodando a query novamente. O tamanho disso pode também causar problemas se não for usado rapidamente.</li>
</ul>
<h2>Implementando Transações com TransactionScope (System.Transactions)</h2>
<p><em>TransactionScope</em> é simples e poderoso. Vamos ao código e algumas características importantes:</p>
<p><script src="https://gist.github.com/edneypitta/4301d7d19b837bdb4c87.js"></script></p>
<ul>
<li>O método Complete() faz com que todas as alterações sejam comitadas. Se não for chamado, todas elas são desfeitas.</li>
<li>Caso alguma Exception seja lançada dentro do bloco using, todas as alterações serão desfeitas também.</li>
<li>A transação é promovida de simples para distribuída automaticamente quando a segunda SqlConnection é aberta.</li>
<li>Mesmo numa transação distribuída, há algumas limitações óbvias. Cópias de arquivos e chamadas para web services, por exemplo, não são revertidas (alguns web services podem até suportar transações, mas isso não acontece automaticamente). Há também o requerimento de que o banco de dados suporte transações, o que não acontece com todos.</li>
</ul>
<h2>Implementando Transações com EntityTransaction</h2>
<p>Você pode implementar transações com a classe EntityTransaction para as classes EntityCommand e EntityConnection. Ela tem duas principais propriedades: Connection e IsolationLevel. Tem também dois métodos importantes e óbvios: Commit() e Rollback().</p>
<p>Um ponto não óbvio e importantíssimo é que, usando DbContext ou ObjectContext (explicados <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-1-choose-data-access-technologies-parte-2-entity-framework/" target="_blank">aqui</a>), não é necessário usar a classe EntityTransaction. Em qualquer DbContext.SaveChanges(), por exemplo, o Entity Framework usa uma transação para salvar todas as modificações feitas. Caso aconteça algum erro, uma Exception é lançada e todas as alterações são desfeitas.</p>
<p>Caso queira usar a classe EntityTransaction para explicitamente fazer uma transação, o caminho é bem simples. Basta criar uma EntityCoonnection, declarar uma Entity Transaction chamando BeginTransaction() e, no final, chamar o método Commit() ou Rollback(). Segue o código:</p>
<p><script src="https://gist.github.com/edneypitta/bb94e2e8539641cd452c.js"></script></p>
<h2>Implementando Transações com SqlTransaction</h2>
<p>O comportamento de uma SqlTransaction é quase idêntico ao de uma EntityTransaction. As mudanças estão nos nomes dos objetos e seus tipos.</p>
<p>Você deve criar uma SqlConnection, chamar o método BeginTransaction() passando um IsolationLevel e criar um ou mais SqlCommands passando como parâmetro o CommandText, a SqlConnection e a SqlTransaction. Ao invés de um CommandText, também é possível passar o nome de uma Stored Procedure e mudar o tipo do CommandType para StoredProcedure.</p>
<p>Depois de toda a lógica feita, basta chamar o método Commit() ou Rollback().</p>
<p>Uma última dica para o exame: se você for perguntado qual é o melhor cenário para aplicar uma transação entre uma query longa que envolve várias tabelas e uma query rápida que envolve uma tabela, escolha a última opção. Embora aparentemente uma query que envolve várias tabelas pareça o ideal, o livro alega que a duração e complexidade geraria colocaria problemas de lock e contenção. Então tá, né?</p>
<p>O próximo post será sobre o objetivo 1.4, <strong><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-4-implement-data-storage-in-windows-azure/">Implement data storage in Windows Azure</a></strong>.<br />
Até lá!</p>

				<p><a class="btn btn-default read-more" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-3-implement-transactions/" title="Certificação Microsoft 70-487: Objetivo 1.3 – Implement transactions">Leia Mais</a></p>

							</div><!-- .entry-content -->
					</div>
	</div>
</article><!-- #post-## -->

			
				
<article id="post-244" class="post-244 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
	<div class="blog-item-wrap">
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-2-implement-caching/" title="Certificação Microsoft 70-487: Objetivo 1.2 – Implement caching" >
			 				</a>
		<div class="post-inner-content">
			<header class="entry-header page-header">

				<h1 class="entry-title"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-2-implement-caching/" rel="bookmark">Certificação Microsoft 70-487: Objetivo 1.2 – Implement caching</a></h1>

								<div class="entry-meta">
					<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-2-implement-caching/" rel="bookmark"><time class="entry-date published" datetime="2016-01-06T02:45:14+00:00">06/01/2016</time><time class="updated" datetime="2016-03-01T16:55:40+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>				<span class="comments-link"><i class="fa fa-comment-o"></i><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-2-implement-caching/#respond"><span class="dsq-postid" data-dsqidentifier="244 https://edneypitta.github.io/old-blog/?p=244">Deixe um comentário</span></a></span>
				
				
				</div><!-- .entry-meta -->
							</header><!-- .entry-header -->

						<div class="entry-content">

				<p>O objetivo 1.2 do exame 70-487: Developing Microsoft Azure and Web Services, <strong>Implement caching</strong>, trata-se de implementações de cache. Nesse objetivo, é necessário que você se familiarize com dois objetos de cache: <em>ObjectCache</em> e o <em>HttpContext.Cache</em>.</p>
<h2>ObjectCache</h2>
<p>O ObjectCache provê a funcionalidade de cache com extrema facilidade. Basta obter a instância dele usando MemoryCache.Default e usar os métodos que têm nomes amigáveis como Add, AddOrGetExisting, Get e Set. Pode não ser fácil memorizar todos os overloads, mas já chegamos lá. Primeiro dê uma olhada num uso simples do ObjectCache:</p>
<p><script src="https://gist.github.com/edneypitta/fa87c7423cb6e330f6e9.js"></script></p>
<p>Note que é necessário primeiro remover o item do cache antes de chamar o método Add. Isso ocorre porque internamente o método Add usa o método AddOrGetExisting, então ele não substitui o valor anterior. Para obter um valor, você pode usar o método Get ou chamar diretamente o indexador (<em>cache[key]</em>).</p>
<p>Vamos às diferentes formas de adicionar um item no cache:</p>
<ul>
<li>Add(CacheItem, CacheItemPolicy)</li>
<li>Add(String key, Object value, DateTimeOffset absoluteExpiration)</li>
<li>Add(String key, Object value, CacheItemPolicy policy, String regionName)</li>
<li>AddOrGetExisting(CacheItem, CacheItemPolicy)</li>
<li>AddOrGetExisting(String key, Object value, DateTimeOffset absoluteExpiration)</li>
<li>AddOrGetExisting(String key, Object value, CacheItemPolicy policy, String regionName)</li>
<li>Set(CacheItem, CacheItemPolicy)</li>
<li>Set(String key, Object value, CacheItemPolicy policy, String regionName)</li>
</ul>
<p>Embora numerosos, esses overloads são bem parecidos. Certifique-se de memorizá-los. </p>
<p>O efeito de todos eles é bem parecido. A principal diferença é que o método Add, por internamente usar o método AddOrGetExisting, retorna um bool indicando se o item foi inserido no cache ou se ele já existia. Já o método Set não tem retorno e atualiza o valor se o item já estiver no cache.</p>
<p>O objeto <em>CacheItem</em> tem três propriedades: Key, Value e RegionName. </p>
<p>No objeto <em>CacheItemPolicy</em>, você pode setar a política de expiração usando a propriedade <strong>AbsoluteExpiration </strong>ou a <strong>SlidingExpiration</strong>. A diferença entre as duas é que, com AbsoluteExpiration, você determina exatamente a data em que o item vai ser removido do cache. Já com SlidingExpiration, o item é removido do cache se não for utilizado após o tempo (TimeSpan) determinado.</p>
<p>Ainda no CacheItemPolicy, você pode configurar também a propriedade Priority com o enum <em>CacheItemPriority</em>. No System.Runtime.Caching (ObjectCache), ele tem dois possíveis valores: <strong>Default </strong>(que é o marcado por padrão) e <strong>NotRemovable</strong>. A propriedade Priority funciona assim: quando os recursos de processamento estão baixos, o runtime pode limpar algumas coisas da memória para melhorar o processamento. Os itens do cache estão incluídos nessa limpeza. Esse é o comportamento padrão, adotado quando a Priority está com o valor Default. Os itens do cache adicionados com o valor NotRemovable na propriedade Prority nunca são removidos do cache pelo runtime. Isso é perigoso pois a aplicação pode <em>crashar</em> devido à falta de memória.</p>
<p>O objeto CacheItemPolicy conta ainda com uma lista de <em>ChangeMonitor</em>. Esse objeto, como o nome sugere, lida com mudanças (eventos) que causam atualização do cache. ChangeMonitor é uma classe base que tem várias implementações:</p>
<ul>
<li><em>CacheEntryChangeMonitor</em>: serve como base para a construção de classes derivadas que monitoram os CacheItems</li>
<li><em>FileChangeMonitor</em>: monitora um arquivo checando se há mudanças para atualizar o cache</li>
<li><em>HostFileChangeMonitor</em>: monitora mudanças em diretórios e caminhos de arquivos, como o nome ou tamanho de um arquivo.</li>
</ul>
<h2>HttpContext.Cache</h2>
<p>O HttpContext.Cache foi criado para ser usado especificamente numa aplicação web ASP.NET (fica em System.Web.Caching). Tome cuidado para não confundir os dois no exame. Se alguma questão mencionar o objeto HttpContext.Cache, Page.Cache ou somente Cache, você <strong>deve</strong> assumir que se trata de uma aplicação ASP.NET. Quaisquer outras menções à cache, pode se assumir que se trata do ObjectCache.</p>
<p>O jeito mais simples de adicionar ou atualizar um item no HttpContext.Cache é assim: <code>Cache["FullNameKey"] = "John Q. Public";</code>. Há também os métodos Add e Insert, que contêm várias sobrecargas (e infelizmente você também deve memorizar todas elas):</p>
<ul>
<li>Insert(String Key, Object Value)</li>
<li>Insert(String Key, Object Value, CacheDependency dependencyItem)</li>
<li>Insert(String Key, Object Value, CacheDependency dependencyItem, DateTime absoluteExpiration, TimeSpan slidingExpiration)</li>
<li>Insert(String Key, Object Value, CacheDependency dependencyItem, DateTime absoluteExpiration, TimeSpan slidingExpiration, CacheItemUpdateCallback updateCallback)</li>
<li>Insert(String Key, Object Value, CacheDependency dependencyItem, DateTime absoluteExpiration, TimeSpan slidingExpiration, CacheItemPriority priority, CacheItemRemovedCallback removeCallback)</li>
<li>Add(string key, object value, CacheDependency dependencies, DateTime absoluteExpiration, TimeSpan slidingExpiration, CacheItemPriority priority, CacheItemRemovedCallback onRemoveCallback)</li>
</ul>
<p>O método Add e a última forma do método Insert são virtualmente idênticos. A principal diferença está no método Insert que usa um <em>CacheItemUpdateCallback</em>, ao contrário do método Add que usa um <em>CacheItemRemovedCallback</em>. Em RemoveCallback é chamado quando o item é removido do cache, enquanto UpdateCallback é invocado <em>um pouco</em> antes do item ser removido do cache. Para a maioria das aplicações isso não faz muita diferença, mas a ideia é que se você precisa se certificar que um item nunca seja removido do cache, por exemplo, use UpdateCallback.</p>
<p>Assim como no ObjectCache, temos aqui também o enum <em>CacheItemPriority</em>, que funciona da mesma forma. A diferença é que aqui há mais opções de valores, com nomes bem sugestivos: <strong>Low</strong>, <strong>BelowNormal</strong>, <strong>Normal</strong>, <strong>AboveNormal</strong>, <strong>High</strong>, <strong>NotRemovable </strong>e <strong>Default</strong>. O valor padrão é Normal, que funciona da mesma forma que Default.</p>
<p>Para finalizar, há o parâmetro <em>CacheDependency</em>, que lida com cache de arquivos (como o HostFileChangeMonitor). Você pode passar também um objeto bem importante, o <em>SqlCacheDependency</em>. Ele tem dois construtores: um que aceita um SqlCommand e outro que aceita duas strings, a primeira sendo o nome do banco definido no web.config e a segunda é o nome da tabela que o cache será associado. Há muitos requisitos para se usar SqlCacheDependency, e alguns cuidados devem ser tomados.<br />
Para o primeiro construtor, o banco de dados deve ser SQL Server 2005 ou superior. Dentro do SqlCommand, as tabelas devem ser referenciadas com o owner (<em>dbo.Customer</em>, por exemplo). <em>SELECT *</em> é proibido e a página não pode ter output caching.<br />
O segundo é ainda mais complicado. Deve haver uma connection string no web.config da aplicação (obviamente). O banco de dados e a tabela devem ter notificações habilitadas no SQL Server e não é possível associar o cache com mais de uma tabela.</p>
<p>E <strong>é isso</strong>. O conteúdo desse objetivo foi bem simples, apesar de ser difícil decorar todos os overloads dos métodos de inserção.</p>
<p>Nos vemos no post do próximo objetivo, <strong><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-3-implement-transactions/">Implement transactions</a></strong>.<br />
Até mais!</p>

				<p><a class="btn btn-default read-more" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-1-2-implement-caching/" title="Certificação Microsoft 70-487: Objetivo 1.2 – Implement caching">Leia Mais</a></p>

							</div><!-- .entry-content -->
					</div>
	</div>
</article><!-- #post-## -->

			
			
		
		</main><!-- #main -->
	</section><!-- #primary -->

</div>
	<div id="secondary" class="widget-area col-sm-12 col-md-4" role="complementary">
		<div class="well">
						<aside id="text-3" class="widget widget_text">			<div class="textwidget"><a href="https://edneypitta.github.io/old-blog/sobre/"><img src="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/IMG-20150829-WA00012-e1440915174271-150x150.jpg"  width="150" height="150" class="aligncenter size-thumbnail wp-image-93" style="border-radius: 80px;" />
<h2 style="text-align:center;">Edney Pitta</h2></a>
<div style="text-align: center;">Desenvolvedor de Software @ Lambda3</div>
<div style="margin-top:20px;text-align:center;"><a href="https://edneypitta.github.io/old-blog/sobre/"><button class="btn btn-danger btn-lg " >SOBRE MIM</button></a></div></div>
		</aside><aside id="search-2" class="widget widget_search">
<form role="search" method="get" class="form-search" action="https://edneypitta.github.io/old-blog/">
  <div class="input-group">
  	<label class="screen-reader-text" for="s">Search for:</label>
    <input type="text" class="form-control search-query" placeholder="Procurar&hellip;" value="" name="s" title="Search for:" />
    <span class="input-group-btn">
      <button type="submit" class="btn btn-default" name="submit" id="searchsubmit" value="Search"><span class="glyphicon glyphicon-search"></span></button>
    </span>
  </div>
</form></aside>		<aside id="recent-posts-3" class="widget widget_recent_entries">		<h3 class="widget-title">Posts recentes</h3>		<ul>
					<li>
				<a href="https://edneypitta.github.io/old-blog/migrando-um-projeto-asp-net-core-rc-1-para-rc-2/">Migrando um projeto ASP.NET Core RC 1 para RC 2</a>
						</li>
					<li>
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-486-developing-asp-net-mvc-web-applications/">Certificação Microsoft 70-486: Developing ASP.NET MVC Web Applications</a>
						</li>
					<li>
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-480-programming-in-html5-with-javascript-and-css3/">Certificação Microsoft 70-480: Programming in HTML5 with JavaScript and CSS3</a>
						</li>
					<li>
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-resultado/">Certificação Microsoft 70-487 &#8211; Resultado</a>
						</li>
					<li>
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-5-6-share-assemblies-between-multiple-applications-and-servers/">Certificação Microsoft 70-487: Objetivo 5.6 – Share assemblies between multiple applications and servers</a>
						</li>
				</ul>
		</aside>		<aside id="annual_archive_widget-2" class="widget Annual_Archive_Widget"><h3 class="widget-title">Arquivo</h3>	<ul>
		<li><a href='https://edneypitta.github.io/old-blog/2016/06/'>junho 2016</a>&nbsp;(1)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2016/05/'>maio 2016</a>&nbsp;(1)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2016/04/'>abril 2016</a>&nbsp;(1)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2016/03/'>março 2016</a>&nbsp;(10)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2016/02/'>fevereiro 2016</a>&nbsp;(11)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2016/01/'>janeiro 2016</a>&nbsp;(10)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2015/12/'>dezembro 2015</a>&nbsp;(3)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2015/11/'>novembro 2015</a>&nbsp;(3)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2015/10/'>outubro 2015</a>&nbsp;(1)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2015/09/'>setembro 2015</a>&nbsp;(5)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2015/08/'>agosto 2015</a>&nbsp;(2)</li>
	</ul>
	</aside>		</div>
	</div><!-- #secondary -->
			</div><!-- close .*-inner (main-content or sidebar, depending if sidebar is used) -->
		</div><!-- close .row -->
	</div><!-- close .container -->
</div><!-- close .site-content -->

	<div id="footer-area">
		<div class="container footer-inner">
			<div class="row">
				
				</div>
		</div>

		<footer id="colophon" class="site-footer" role="contentinfo">
			<div class="site-info container">
				<div class="row">
										<nav role="navigation" class="col-md-6">
						<ul id="menu-social-1" class="nav footer-nav clearfix"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20"><a href="https://br.linkedin.com/in/edneypitta"><i class="fa fa-linkedin-square"></i></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22"><a href="https://www.facebook.com/edneypitta"><i class="fa fa-facebook-square"></i></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-23"><a href="https://twitter.com/edneypitta"><i class="fa fa-twitter-square"></i></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24"><a href="https://edneypitta.github.io/old-blog/feed/"><i class="fa fa-rss"></i></a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-27"><a href="https://edneypitta.github.io/old-blog/sobre/"><i class="fa fa-info-circle"></i></a></li>
</ul>					</nav>
					<div class="copyright col-md-6">
						<a rel="license" href="http://creativecommons.org/licenses/by/2.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/2.0/80x15.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/2.0/">Creative Commons Attribution 2.0 Generic License</a>.						Theme by <a href="http://colorlib.com/" target="_blank">Colorlib</a> Powered by <a href="http://wordpress.org/" target="_blank">WordPress</a>					</div>
				</div>
			</div><!-- .site-info -->
			<div class="scroll-to-top"><i class="fa fa-angle-up"></i></div><!-- .scroll-to-top -->
		</footer><!-- #colophon -->
	</div>
</div><!-- #page -->

<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/js/skip-link-focus-fix.js?ver=20140222'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-includes/js/wp-embed.min.js?ver=4.8.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"edneypitta"};
/* ]]> */
</script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/plugins/disqus-comment-system/media/js/count.js?ver=4.8.2'></script>

</body>
</html>