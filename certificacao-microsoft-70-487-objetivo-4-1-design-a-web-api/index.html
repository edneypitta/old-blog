<!doctype html>
	<!--[if !IE]>
	<html class="no-js non-ie" lang="pt-BR" prefix="og: http://ogp.me/ns#"> <![endif]-->
	<!--[if IE 7 ]>
	<html class="no-js ie7" lang="pt-BR" prefix="og: http://ogp.me/ns#"> <![endif]-->
	<!--[if IE 8 ]>
	<html class="no-js ie8" lang="pt-BR" prefix="og: http://ogp.me/ns#"> <![endif]-->
	<!--[if IE 9 ]>
	<html class="no-js ie9" lang="pt-BR" prefix="og: http://ogp.me/ns#"> <![endif]-->
	<!--[if gt IE 9]><!-->
<html class="no-js" lang="pt-BR" prefix="og: http://ogp.me/ns#"> <!--<![endif]-->
<head>
<base href="https://edneypitta.github.io/old-blog" />

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Certifica√ß√£o Microsoft 70-487: Objetivo 4.1 ‚Äì Design a Web API - Edney Pitta</title>

<!-- This site is optimized with the Yoast SEO plugin v3.0.7 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="O primeiro objetivo do cap√≠tulo sobre Web API, Design a Web API, cobre como escolher um m√©todo HTTP apropriado, definir recursos HTTP com actions, usar rotas, escolher formatos e planejar quando usar actions ass√≠ncronas. Vamos l√°?"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-4-1-design-a-web-api/" />
<meta property="og:locale" content="pt_BR" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Certifica√ß√£o Microsoft 70-487: Objetivo 4.1 ‚Äì Design a Web API - Edney Pitta" />
<meta property="og:description" content="O primeiro objetivo do cap√≠tulo sobre Web API, Design a Web API, cobre como escolher um m√©todo HTTP apropriado, definir recursos HTTP com actions, usar rotas, escolher formatos e planejar quando usar actions ass√≠ncronas. Vamos l√°?" />
<meta property="og:url" content="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-4-1-design-a-web-api/" />
<meta property="og:site_name" content="Edney Pitta" />
<meta property="article:publisher" content="https://www.facebook.com/edneypitta" />
<meta property="article:tag" content="70-487" />
<meta property="article:section" content="Certifica√ß√£o" />
<meta property="article:published_time" content="2016-02-26T10:16:29+00:00" />
<meta property="article:modified_time" content="2016-03-01T16:58:30+00:00" />
<meta property="og:updated_time" content="2016-03-01T16:58:30+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="O primeiro objetivo do cap√≠tulo sobre Web API, Design a Web API, cobre como escolher um m√©todo HTTP apropriado, definir recursos HTTP com actions, usar rotas, escolher formatos e planejar quando usar actions ass√≠ncronas. Vamos l√°?"/>
<meta name="twitter:title" content="Certifica√ß√£o Microsoft 70-487: Objetivo 4.1 ‚Äì Design a Web API - Edney Pitta"/>
<meta name="twitter:site" content="@edneypitta"/>
<meta name="twitter:creator" content="@edneypitta"/>
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />



		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/edneypitta.github.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.2"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='sparkling-bootstrap-css'  href='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/css/bootstrap.min.css?ver=4.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='sparkling-icons-css'  href='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/css/font-awesome.min.css?ver=4.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='sparkling-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans%3A400italic%2C400%2C600%2C700%7CRoboto+Slab%3A400%2C300%2C700&#038;ver=4.8.2' type='text/css' media='all' />
<link rel='stylesheet' id='sparkling-style-css'  href='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/style.css?ver=4.8.2' type='text/css' media='all' />
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/js/modernizr.min.js?ver=4.8.2'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/js/bootstrap.min.js?ver=4.8.2'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/js/functions.min.js?ver=4.8.2'></script>
<link rel='https://api.w.org/' href='https://edneypitta.github.io/old-blog/wp-json/' />

 

<link rel='shortlink' href='https://edneypitta.github.io/old-blog/?p=482' />


<script data-cfasync="false" src="//load.sumome.com/" data-sumo-site-id="025f16b2b72012bef5c86b74ea4d0bd0652e8245a2df8c61ed302458c0f98f3b" async></script><style type="text/css">.entry-content {font-family: Open Sans; font-size:14px; font-weight: normal; color:#6B6B6B;}.navbar > .container .navbar-brand {
font-size: 35px;
margin-top: 7px;
}

#menu-social i{
font-size:17px;
}
#menu-social-1 i {
font-size:22px;
}

article ul {
    list-style: none;
    padding:0;
    margin:0;
margin-bottom: 10px;
}

article li { 
    padding-left: 1em; 
    text-indent: -.7em;
}

article li:before {
    content: "\2022";
    color: rgb(191, 66, 78); 
padding-right:7px;
font-size: 15px;
}

#logo {
margin: 10px 0px;
}

.textwidget a:hover h2{
color:#c9302c;
}</style>	<style type="text/css">
			.navbar > .container .navbar-brand {
			color: #ffffff;
		}
		</style>
	<link rel="icon" href="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/cropped-cropped-edneypitta-oficialissimo-fundo-branco-32x32.png" sizes="32x32" />
<link rel="icon" href="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/cropped-cropped-edneypitta-oficialissimo-fundo-branco-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/cropped-cropped-edneypitta-oficialissimo-fundo-branco-180x180.png" />
<meta name="msapplication-TileImage" content="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/cropped-cropped-edneypitta-oficialissimo-fundo-branco-270x270.png" />

<script type="text/javascript">
jQuery(document).ready(function()
{
jQuery('.fa-linkedin-square').parent().attr('target', '_blank').attr('title', 'LinkedIn');
jQuery('.fa-facebook-square').parent().attr('target', '_blank').attr('title', 'Facebook');
jQuery('.fa-twitter-square').parent().attr('target', '_blank').attr('title', 'Twitter');
jQuery('.fa-rss').parent().attr('target', '_blank').attr('title', 'RSS');

jQuery('.fa-info-circle').parent().attr('title', 'Sobre');
});
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66613004-1', 'auto');
  ga('send', 'pageview');

</script>
</head>

<body class="post-template-default single single-post postid-482 single-format-standard">
<div id="page" class="hfeed site">

	<header id="masthead" class="site-header" role="banner">
		<nav class="navbar navbar-default" role="navigation">
			<div class="container">
				<div class="row">
					<div class="site-navigation-inner col-sm-12">
						<div class="navbar-header">
							<button type="button" class="btn navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
								<span class="sr-only">Toggle navigation</span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
							</button>

							
							<div id="logo">
								<a href="https://edneypitta.github.io/old-blog/"><img src="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/cropped-edneypitta-oficialissimo-fundo-branco.png"  height="84" width="411" alt="Edney Pitta"/></a>
							</div><!-- end of #logo -->

							
							
						</div>
						<div class="collapse navbar-collapse navbar-ex1-collapse"><ul id="menu-social" class="nav navbar-nav"><li id="menu-item-20" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20"><a title="&lt;i class=&quot;fa fa-linkedin-square&quot;&gt;&lt;/i&gt;" href="https://br.linkedin.com/in/edneypitta"><i class="fa fa-linkedin-square"></i></a></li>
<li id="menu-item-22" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22"><a title="&lt;i class=&quot;fa fa-facebook-square&quot;&gt;&lt;/i&gt;" href="https://www.facebook.com/edneypitta"><i class="fa fa-facebook-square"></i></a></li>
<li id="menu-item-23" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-23"><a title="&lt;i class=&quot;fa fa-twitter-square&quot;&gt;&lt;/i&gt;" href="https://twitter.com/edneypitta"><i class="fa fa-twitter-square"></i></a></li>
<li id="menu-item-24" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24"><a title="&lt;i class=&quot;fa fa-rss&quot;&gt;&lt;/i&gt;" href="https://edneypitta.github.io/old-blog/feed/"><i class="fa fa-rss"></i></a></li>
<li id="menu-item-27" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-27"><a title="&lt;i class=&quot;fa fa-info-circle&quot;&gt;&lt;/i&gt;" href="https://edneypitta.github.io/old-blog/sobre/"><i class="fa fa-info-circle"></i></a></li>
</ul></div>					</div>
				</div>
			</div>
		</nav><!-- .site-navigation -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">

		<div class="top-section">
								</div>

		<div class="container main-content-area">
			<div class="row">
				<div class="main-content-inner col-sm-12 col-md-8 pull-left">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-482" class="post-482 post type-post status-publish format-standard hentry category-certificacao tag-70-487">
		<div class="post-inner-content">
		<header class="entry-header page-header">

			<h1 class="entry-title ">Certifica√ß√£o Microsoft 70-487: Objetivo 4.1 ‚Äì Design a Web API</h1>

			<div class="entry-meta">
				<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-4-1-design-a-web-api/" rel="bookmark"><time class="entry-date published" datetime="2016-02-26T10:16:29+00:00">26/02/2016</time><time class="updated" datetime="2016-03-01T16:58:30+00:00">01/03/2016</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://edneypitta.github.io/old-blog/author/admin/">Edney Pitta</a></span></span>
								<span class="cat-links"><i class="fa fa-folder-open-o"></i>
					 <a href="https://edneypitta.github.io/old-blog/category/certificacao/" rel="category tag">Certifica√ß√£o</a>				</span>
								
			</div><!-- .entry-meta -->
		</header><!-- .entry-header -->

		<div class="entry-content">
			<p>Ol√° pessoal!</p>
<p>Hoje vamos come√ßar o primeiro objetivo do cap√≠tulo sobre Web API, <strong>Design a Web API</strong>. Esse objetivo cobre como escolher um m√©todo HTTP apropriado, definir recursos HTTP com actions, usar rotas, escolher formatos e planejar quando usar actions ass√≠ncronas. Vamos l√°?</p>
<h2>Escolhendo M√©todos HTTP</h2>
<p>Resumindo a introdu√ß√£o, Web API √© um servi√ßo REST (Representational State Transfer) baseado em HTTP. Ao inv√©s de chamar um m√©todo espec√≠fico, como no WCF, com Web API voc√™ faz uma chamada para uma URL em conjunto com um m√©todo HTTP.</p>
<p>Segue uma lista com os m√©todos HTTP existentes e depois entraremos em detalhes sobre os mais importantes:</p>
<ul>
<li><strong>Delete</strong>: deleta a entidade;</li>
<li><strong>Get</strong>: obt√©m os dados de uma ou mais entidades;</li>
<li><strong>Put</strong>: atualiza a entidade inteira;</li>
<li><strong>Patch</strong>: atualiza parcialmente a entidade;</li>
<li><strong>Post</strong>: cria uma nova entidade;</li>
<li><strong>Head</strong>: recupera somente os headers;</li>
<li><strong>Options</strong>: requisita informa√ß√µes sobre as op√ß√µes dispon√≠veis de comunica√ß√£o.</li>
</ul>
<h4>HttpGet</h4>
<p>Geralmente o m√©todo mais usado, o HttpGet serve para obter dados de uma ou mais entidades. Ou seja, para cada entidade em um modelo, geralmente haver√° um Get para obter todos os itens e outro Get para obter os detalhes de um item espec√≠fico:</p>
<p><code>"/api/Foos" // obt√©m lista de todos os Foos<br />
"/api/Foos/keyvalue" // obt√©m um Foo com a key especificada<br />
"/api/Foos?attributename=attributevalue" // obt√©m um ou mais Foos com os atributos especificados</code></p>
<p>Caso nenhum valor seja encontrado, √© importante lan√ßar uma HttpResponseException com HttpStatusCode.NotFound (404) ao inv√©s de simplesmente lan√ßar uma Exception.</p>
<h4>HttpDelete</h4>
<p>Talvez o mais simples de todos, o HttpDelete simplesmente deleta uma entidade com o valor especificado, geralmente a chave. √â aconselh√°vel usar o prefixo <em>Delete</em> no nome do m√©todo do controller Web API.</p>
<p>Idealmente, h√° 3 poss√≠veis retornos para um request Delete: </p>
<ul>
<li>HttpStatusCode.OK (200), que indica sucesso;</li>
<li>HttpStatusCode.Accepted (202), que indica que o request foi processado e aceito mas est√° ainda pendente;</</li>
<li>HttpStatusCode.NoResponse (204), valor padr√£o para m√©todos com retorno void</li>
</ul>
<h4>HttpPost</h4>
<p>Para criar uma nova entidade, o m√©todo HttpPost deve ser usado. Assim como em Delete, o prefixo <em>Post</em> deve ser utilizado.</p>
<p>Em caso de sucesso, o retorno estipulado pelo protocolo HTTP 1.1 √© HttpStatusCode.Created (201), mas o status code padr√£o √© 200 (OK). √â tamb√©m aconselh√°vel retornar a localiza√ß√£o (URL) de detalhes da nova entidade criada. Seguindo esses padr√µes, a implementa√ß√£o de um HttpPost para criar uma Account seria assim:</p>
<p><code>[HttpPost]<br />
public HttpResponseMessage PostAccount(Account account)<br />
{<br />
HttpResponseMessage response = Request.CreateResponse<Account>(HttpStatusCode.Created, account);<br />
string newUri = Url.Link("NamedApi", new { accountId = account.AccountId });<br />
response.Headers.Location = new Uri(newUri);<br />
return response;<br />
}</code></p>
<h4>HttpPut</h4>
<p>HttpPut deve ser utilizado para opera√ß√µes <em>upserts</em>, que inserem novos registros ou atualizam registros existentes. Tamb√©m devem utilizar o prefixo <em>Put</em>.</p>
<p>Para atualizar uma Account, por exemplo, voc√™ deve receber um Id para procurar e uma Account para atualizar os valores. A implementa√ß√£o seria assim:</p>
<p><code>[HttpPut]<br />
public HttpResponseMessage PutAccount(int id, Account account)<br />
{<br />
// perform insert and/or edit here.<br />
}</code></p>
<h2>Definindo Recursos HTTP Com Actions</h2>
<p>Um servi√ßo Web API nada mais √© do que uma aplica√ß√£o que usa controllers e actions para mapear URLs com a√ß√µes HTTP. Esta se√ß√£o foca no b√°sico de como construir uma aplica√ß√£o Web API.</p>
<h4>Criando O Model</h4>
<p>Voltando um pouco ao cap√≠tulo anterior, em WCF era necess√°rio decorar suas classes com os atributos DataContract e DataMember para trafeg√°-las pelos servi√ßos.</p>
<p>Com Web API, isso n√£o √© mais necess√°rio. O pr√≥prio framework toma conta de enviar sua classe via HTTP, serializada em JSON ou XML. Isso evita o acoplamento entre seu modelo e o servi√ßo que o exp√µe, al√©m de facilitar os poss√≠veis clients desse servi√ßo pelo fato de JSON e XML serem praticamente universais.</p>
<p>Para os exemplos a seguir, vamos considerar o seguinte model:</p>
<p><script src="https://gist.github.com/edneypitta/167b3d7653d04b2112fb.js"></script></p>
<h4>Criando O Controller</h4>
<p>Os controllers s√£o as classes que definem os servi√ßos da sua Web API. Eles herdam de <em>ApiController</em> e cada m√©todo p√∫blico vira uma <em>action</em>, como se fosse um m√©todo no WCF.</p>
<p>Veja a implementa√ß√£o dos controllers abaixo. Seguindo o padr√£o REST, √© criado um servi√ßo para cada tipo no modelo:</p>
<p><script src="https://gist.github.com/edneypitta/51124e2030818e670284.js"></script></p>
<p><script src="https://gist.github.com/edneypitta/4f8d4763dd6d01e8f0b4.js"></script></p>
<p>Com isso, voc√™ j√° tem sua Web API funcionando. Basta acessar <code>http://localhost:{porta}/api/Account</code> e a lista de Accounts √© retornada. Chamando <code>/api/Account?accountId=1</code>, a Account com o Id 1 √© retornada. </p>
<p>Um ponto importante √© que, chamando essas URLs diretamente no browser, o comportamento √© definido pelo pr√≥prio browser. O Chrome e o Firefox, por exemplo, mostrariam um XML na tela, enquanto o Internet Explorer faria o download de um JSON. Isso varia do request header <strong>Accept </strong>que o browser envia para a Web API.</p>
<h2>Definindo Rotas</h2>
<p>Toda a m√°gica da Web API de tornar m√©todos p√∫blicos em um controller acess√≠veis por clients acontece por causa da <em>Routing Table</em>. </p>
<p>Routing Table √© um classe que implementa <em>System.Web.Http.Routing.IHttpRoute</em> e tem a tarefa de mepear um request para um controller e uma action espec√≠ficos. No caso de Web API, a classe se chama WebApiConfig e fica dentro de App_Start:</p>
<p><script src="https://gist.github.com/edneypitta/bc41c4fabf2f6f1035d7.js"></script></p>
<p>Se voc√™ mudar o routeTemplate para <code>"data/{controller}/{id}"</code>, por exemplo, voc√™ agora acessa sua api com <code>http://localhost:{porta}/data/Account</code>.</p>
<p>Quando uma requisi√ß√£o √© feita para uma Web API, o framework tenta achar o controller e a action segundo o que est√° definido na Routing Table. Se n√£o encontra, uma HttpStatusCode 404 √© retornado. Caso contr√°rio, o request √© encaminhado para o m√©todo. As seguintes a√ß√µes s√£o tomadas pelo framework para encontrar o controller e a action:</p>
<ul>
<li>Para achar o controller, a Web API adiciona a palavra <em>Controller</em> na vari√°vel do controller (por isso voc√™ chama diretamente Account, por exemplo);</li>
<li>Para a action, a Web API examina o m√©todo HTTP do request e tenta achar uma action com o nome correspondente;</li>
<li>Por padr√£o, isso s√≥ funciona com os m√©todos GET, POST, PUT e DELETE. Outro m√©todos s√£o suportados, mas outro mecanismo √© utilizado;</li>
<li>Por √∫ltimo, as vari√°veis no routeTemplate s√£o mapeadas para os par√¢metros da action (por padr√£o, <em>id</em>).</li>
</ul>
<p>Voc√™ pode setar explicitamente um m√©todo HTTP em uma action. Isso √© importante quando voc√™ quer que o nome do m√©todo seja diferente do m√©todo HTTP. Para fazer isso, basta decorar o m√©todo com o atributo <em>System.Web.Http.ActionMethodSelectorAttribute</em>. Ele possui 4 valores: HttpGet, HttpPost, HttpDelete e HttpPut. O m√©todo ficaria assim: </p>
<p><code>[HttpGet]<br />
public Account GetAccount(int accountId)</code></p>
<p>Para definir m√∫ltiplos m√©todos HTTP para uma action ou suportar um m√©todo HTTP fora os 4 citados, voc√™ usa o atributo <em>System.Web.Http.AcceptVerbsAttribute</em>. O construtor aceita um array de strings que correspondem aos m√©todos que devem ser mapeados. O uso ficaria assim:</p>
<p><code>[System.Web.Http.AcceptVerbs("GET", "HEAD")]<br />
public IEnumerable<Customer> GetCustomers(int accountId)</code></p>
<h4>Alterando Actions</h4>
<p>Se voc√™ quiser criar as rotas com o nome da ation expl√≠cito, basta mudar a Routing Table para isso. O c√≥digo ficaria assim:</p>
<p><script src="https://gist.github.com/edneypitta/71116a14432f469431a7.js"></script></p>
<p>Com isso, ao inv√©s de acessar <code>/api/Customer/1</code>, voc√™ acessa <code>/api/Customer/GetCustomers/1</code>. </p>
<p>Voc√™ pode alterar o nome da action pelo atributo <em>ActionNameAttribute</em>:</p>
<p><code>[HttpGet]<br />
[ActionName("FindCustomers")]<br />
public IEnumerable<Customer> SearchCustomers(string lastName)</code></p>
<p>Assim, voc√™ acessa essa action com a URL <code>/api/Customer/FindCustomers?lastName=r</code>.</p>
<p>O √∫ltimo ponto √© que voc√™ pode querer que um m√©todo p√∫blico no controller n√£o seja uma action acess√≠vel pelo servi√ßo. Para isso, decore o m√©todo com o atributo <em>NonAction</em>.</p>
<h2>Escolhendo Formatos</h2>
<p>O request header Accept indica o formato que o client espera como retorno. Acessando sua Web API pelo browser, geralmente o seguinte header √© enviado: </p>
<p><code>Accept: text/html,application/xhtml+xml,application/xml</code></p>
<p>Por padr√£o, a Web API trabalha com JSON e XML. Isso √© configurado por um objeto chamado <em>media-type formatter</em>.</p>
<p>Para essa se√ß√£o, basta voc√™ saber isso e que voc√™ pode adicionar formatters customizados implementando a classe <em>MediaTypeFormatter </em>ou <em>BufferedMediaTypeFormatter</em>.</p>
<h2>Actions Ass√≠ncronas</h2>
<p>Ao fazer um request para um servi√ßo Web API, uma thread √© alocada do servidor para fazer o processamento necess√°rio.<br />
Em cen√°rios de grandes processamentos de I/O (entrada/sa√≠da), como acesso a banco de dados e chamadas a outros servi√ßos, √© importante liberar a thread atual para que ela processe mais requests enquanto essa entrada/sa√≠da longa √© executada.</p>
<p>O C# 5 nos deu mecanismos para fazer isso de forma muito simples: as palavras-chave <em>async </em>e <em>await</em>. Tome por exemplo a seguinte action de uma Web API:</p>
<p><code>public string Get()<br />
{<br />
WebClient webClient = new WebClient();<br />
string result = webClient.DownloadString("http://microsoft.com");<br />
return result;<br />
}</code></p>
<p>Na maior parte do tempo, a thread alocada fica esperando o processamento I/O de fazer o request para o site da microsoft e buscar o HTML. Olhe essa action com async/await:</p>
<p><code>public <strong>async </strong>Task&lt;string&gt; Get()<br />
{<br />
WebClient webClient = new WebClient();<br />
string result = await webClient.DownloadString<strong>TaskAsync</strong>("http://microsoft.com");<br />
return result;<br />
}</code></p>
<p>Na chamada a <code>await webClient.DownloadStringTaskAsync</code>, a thread alocada √© liberada para processar outros requests enquanto a requisi√ß√£o ao site da Microsoft √© feita.</p>
<p>Um √∫ltimo alerta √© que chamadas ass√≠ncronas devem ser feitas <strong>apenas</strong> para processamentos I/O. Se o m√©todo ass√≠ncrono fizer um processamento de CPU, outra thread ter√° que ser alocada para fazer esse processamento, o que invalida quaisquer benef√≠cios da programa√ß√£o ass√≠ncrona (podendo at√© piorar devido √† troca de threads).</p>
<hr />
<p>Chegamos ao fim desse objetivo üôÇ</p>
<p>Obrigado pela leitura e espere pelo pr√≥ximo post sobre o objetivo 4.2, <strong><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-4-2-implement-a-web-api/">Implement a Web API</a></strong>.</p>
<p>At√© mais!</p>
					</div><!-- .entry-content -->

		<footer class="entry-meta">

	    		      <!-- tags -->
	      <div class="tagcloud">

	          <a href="https://edneypitta.github.io/old-blog/tag/70-487/">70-487</a> 
	      </div>
	      <!-- end tags -->
	      
		</footer><!-- .entry-meta -->
	</div>

	
</article><!-- #post-## -->

			
<div id="disqus_thread">
            <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="post pingback">
        <p>Pingback: <a href='https://blog.lambda3.com.br/2016/03/certificacao-microsoft-70-487-developing-microsoft-azure-and-web-services/' rel='external nofollow' class='url'>Certifica√ß√£o Microsoft 70-487: Developing Microsoft Azure and Web Services | Blogs da Lambda3</a>()</p>
    </li>
    </li><!-- #comment-## -->
            </ul>


        </div>

    </div>


				<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Navega√ß√£o de Post</h1>
		<div class="nav-links">
			<div class="nav-previous"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-3-9-host-and-manage-services/" rel="prev"><i class="fa fa-chevron-left"></i> Certifica√ß√£o Microsoft 70-487: Objetivo 3.9 ‚Äì Host and manage services</a></div><div class="nav-next"><a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-4-2-implement-a-web-api/" rel="next">Certifica√ß√£o Microsoft 70-487: Objetivo 4.2 ‚Äì Implement a Web API <i class="fa fa-chevron-right"></i></a></div>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
		
		</main><!-- #main -->
	</div><!-- #primary -->
<script type="text/javascript">

  jQuery(document).ready(function(){
	jQuery('.esconderTextoPagina').remove();
	
  });
</script>

</div>
	<div id="secondary" class="widget-area col-sm-12 col-md-4" role="complementary">
		<div class="well">
						<aside id="text-3" class="widget widget_text">			<div class="textwidget"><a href="https://edneypitta.github.io/old-blog/sobre/"><img src="https://edneypitta.github.io/old-blog/wp-content/uploads/2015/08/IMG-20150829-WA00012-e1440915174271-150x150.jpg"  width="150" height="150" class="aligncenter size-thumbnail wp-image-93" style="border-radius: 80px;" />
<h2 style="text-align:center;">Edney Pitta</h2></a>
<div style="text-align: center;">Desenvolvedor de Software @ Lambda3</div>
<div style="margin-top:20px;text-align:center;"><a href="https://edneypitta.github.io/old-blog/sobre/"><button class="btn btn-danger btn-lg " >SOBRE MIM</button></a></div></div>
		</aside><aside id="search-2" class="widget widget_search">
<form role="search" method="get" class="form-search" action="https://edneypitta.github.io/old-blog/">
  <div class="input-group">
  	<label class="screen-reader-text" for="s">Search for:</label>
    <input type="text" class="form-control search-query" placeholder="Procurar&hellip;" value="" name="s" title="Search for:" />
    <span class="input-group-btn">
      <button type="submit" class="btn btn-default" name="submit" id="searchsubmit" value="Search"><span class="glyphicon glyphicon-search"></span></button>
    </span>
  </div>
</form></aside>		<aside id="recent-posts-3" class="widget widget_recent_entries">		<h3 class="widget-title">Posts recentes</h3>		<ul>
					<li>
				<a href="https://edneypitta.github.io/old-blog/migrando-um-projeto-asp-net-core-rc-1-para-rc-2/">Migrando um projeto ASP.NET Core RC 1 para RC 2</a>
						</li>
					<li>
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-486-developing-asp-net-mvc-web-applications/">Certifica√ß√£o Microsoft 70-486: Developing ASP.NET MVC Web Applications</a>
						</li>
					<li>
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-480-programming-in-html5-with-javascript-and-css3/">Certifica√ß√£o Microsoft 70-480: Programming in HTML5 with JavaScript and CSS3</a>
						</li>
					<li>
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-resultado/">Certifica√ß√£o Microsoft 70-487 &#8211; Resultado</a>
						</li>
					<li>
				<a href="https://edneypitta.github.io/old-blog/certificacao-microsoft-70-487-objetivo-5-6-share-assemblies-between-multiple-applications-and-servers/">Certifica√ß√£o Microsoft 70-487: Objetivo 5.6 ‚Äì Share assemblies between multiple applications and servers</a>
						</li>
				</ul>
		</aside>		<aside id="annual_archive_widget-2" class="widget Annual_Archive_Widget"><h3 class="widget-title">Arquivo</h3>	<ul>
		<li><a href='https://edneypitta.github.io/old-blog/2016/06/'>junho 2016</a>&nbsp;(1)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2016/05/'>maio 2016</a>&nbsp;(1)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2016/04/'>abril 2016</a>&nbsp;(1)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2016/03/'>mar√ßo 2016</a>&nbsp;(10)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2016/02/'>fevereiro 2016</a>&nbsp;(11)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2016/01/'>janeiro 2016</a>&nbsp;(10)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2015/12/'>dezembro 2015</a>&nbsp;(3)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2015/11/'>novembro 2015</a>&nbsp;(3)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2015/10/'>outubro 2015</a>&nbsp;(1)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2015/09/'>setembro 2015</a>&nbsp;(5)</li>
	<li><a href='https://edneypitta.github.io/old-blog/2015/08/'>agosto 2015</a>&nbsp;(2)</li>
	</ul>
	</aside>		</div>
	</div><!-- #secondary -->
			</div><!-- close .*-inner (main-content or sidebar, depending if sidebar is used) -->
		</div><!-- close .row -->
	</div><!-- close .container -->
</div><!-- close .site-content -->

	<div id="footer-area">
		<div class="container footer-inner">
			<div class="row">
				
				</div>
		</div>

		<footer id="colophon" class="site-footer" role="contentinfo">
			<div class="site-info container">
				<div class="row">
										<nav role="navigation" class="col-md-6">
						<ul id="menu-social-1" class="nav footer-nav clearfix"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20"><a href="https://br.linkedin.com/in/edneypitta"><i class="fa fa-linkedin-square"></i></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22"><a href="https://www.facebook.com/edneypitta"><i class="fa fa-facebook-square"></i></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-23"><a href="https://twitter.com/edneypitta"><i class="fa fa-twitter-square"></i></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24"><a href="https://edneypitta.github.io/old-blog/feed/"><i class="fa fa-rss"></i></a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-27"><a href="https://edneypitta.github.io/old-blog/sobre/"><i class="fa fa-info-circle"></i></a></li>
</ul>					</nav>
					<div class="copyright col-md-6">
						<a rel="license" href="http://creativecommons.org/licenses/by/2.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/2.0/80x15.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/2.0/">Creative Commons Attribution 2.0 Generic License</a>.						Theme by <a href="http://colorlib.com/" target="_blank">Colorlib</a> Powered by <a href="http://wordpress.org/" target="_blank">WordPress</a>					</div>
				</div>
			</div><!-- .site-info -->
			<div class="scroll-to-top"><i class="fa fa-angle-up"></i></div><!-- .scroll-to-top -->
		</footer><!-- #colophon -->
	</div>
</div><!-- #page -->

<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/themes/sparkling/inc/js/skip-link-focus-fix.js?ver=20140222'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-includes/js/comment-reply.min.js?ver=4.8.2'></script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-includes/js/wp-embed.min.js?ver=4.8.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"platform":"wordpress@4.8.2","language":""},"disqusIdentifier":"482 http:\/\/edneypitta.github.io\/?p=482","disqusShortname":"edneypitta","disqusTitle":"Certifica\u00e7\u00e3o Microsoft 70-487: Objetivo 4.1 \u2013 Design a Web API","disqusUrl":"http:\/\/edneypitta.github.io\/certificacao-microsoft-70-487-objetivo-4-1-design-a-web-api\/","options":{"manualSync":false},"postId":"482"};
/* ]]> */
</script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/plugins/disqus-comment-system/media/js/disqus.js?ver=4.8.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"edneypitta"};
/* ]]> */
</script>
<script type='text/javascript' src='https://edneypitta.github.io/old-blog/wp-content/plugins/disqus-comment-system/media/js/count.js?ver=4.8.2'></script>

</body>
</html>